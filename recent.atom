<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title type="text">Recent Articles</title>
  <id>http://blog.yoavram.com/recent.atom</id>
  <updated>2013-07-14T12:16:00Z</updated>
  <link href="http://blog.yoavram.com" />
  <link href="http://blog.yoavram.com/recent.atom" rel="self" />
  <author>
    <name>Yoav Ram</name>
    <uri>http://www.yoavram.com/</uri>
    <email>yoavram@gmail.com</email>
  </author>
  <rights>CC BY-SA 3.0</rights>
  <generator>Werkzeug</generator>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Summary: "Evolution of mutation rates in bacteria" (Denamur and Matic 2006)</title>
    <id>http://blog.yoavram.com/denamur-and-matic-2006/</id>
    <updated>2013-07-14T12:16:00Z</updated>
    <link href="http://blog.yoavram.com/denamur-and-matic-2006/" />
    <author>
      <name></name>
    </author>
    <content type="html">
&lt;p&gt;This is an &amp;quot;executive summary&amp;quot; of &lt;a href="http://onlinelibrary.wiley.com/doi/10.1111/j.1365-2958.2006.05150.x/abstract"&gt;Denamur and Matic &lt;span class="citation"&gt;(2006)&lt;/span&gt;&lt;/a&gt;, which is a review of the literature on the evolution of the mutation rate in bactera.&lt;/p&gt;
&lt;ol style="list-style-type: decimal"&gt;
&lt;li&gt;Deleterious mutations are 100,000-fold more frequent than beneficial mutations in &lt;em&gt;E. coli&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Mutators have been found in various species of bacteria in frequencies of 0.1-60%: 1% strong mutators, 10-30% weak mutators &lt;span class="citation"&gt;(Matic et al. 1997; Baquero et al. 2004)&lt;/span&gt;.&lt;/li&gt;
&lt;li&gt;These frequencies are higher than expected under a &lt;strong&gt;mutation-selection balance&lt;/strong&gt; (MSB) - Boe &lt;em&gt;et al.&lt;/em&gt; &lt;span class="citation"&gt;(2000)&lt;/span&gt; estimated the mutator fraction at 0.00003.&lt;/li&gt;
&lt;li&gt;Mutator alleles are mainly mutants in the &lt;strong&gt;mismatch repair (MMR) system&lt;/strong&gt; (&lt;em&gt;mutS&lt;/em&gt;, &lt;em&gt;mutL&lt;/em&gt;) - see the article for more information on the operation of these genes and the MMR system).&lt;/li&gt;
&lt;li&gt;Rate increases by these MMR mutants: &lt;strong&gt;100-fold increase in transitions, 1,000-fold increase in frameshifts and 10-1,000-fold increase in chromosomal rearrangements&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;MMR mutatns arise by different mutation types. The rate of non-mutator to mutator was estimated by Boe &lt;em&gt;et al.&lt;/em&gt; &lt;span class="citation"&gt;(2000)&lt;/span&gt; to be 0.000005 per generation.&lt;/li&gt;
&lt;li&gt;What can cause the frequency of MMR mutants to be higher than that expected under a MSB?
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Higher replication rates&lt;/strong&gt; due to the absence of the metabolic load imposed by DNA repair enzymes&lt;sup&gt;&lt;a href="#fn1" class="footnoteRef" id="fnref1"&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Higher adaptation rate&lt;/strong&gt; due to the faster generation of beneficial mutations&lt;sup&gt;&lt;a href="#fn2" class="footnoteRef" id="fnref2"&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;The first explanation was rejected&lt;/strong&gt;: Several studies found that &lt;strong&gt;mutators are advanageous only when&lt;/strong&gt; the ratio of mutator to non-mutator is such that &lt;strong&gt;beneficial mutations are more likely to be generated by mutators&lt;/strong&gt; than by non-mutators&lt;sup&gt;&lt;a href="#fn3" class="footnoteRef" id="fnref3"&gt;3&lt;/a&gt;&lt;/sup&gt;.&lt;/li&gt;
&lt;li&gt;The second explanation is stonger in bacteria than in other species because &lt;strong&gt;recombination&lt;/strong&gt; rates are low and therefore mutators are not separated from the beneficial mutations they generate.&lt;/li&gt;
&lt;li&gt;Although mutators can reach &lt;strong&gt;high frequencies in adaptive evolution&lt;/strong&gt;, they accumulate deleterious mutations and &lt;strong&gt;decline in frequency in a constant environment&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Migration&lt;/strong&gt; to new environments can change a beneficial mutation to neutral or deleterious.&lt;/li&gt;
&lt;li&gt;Mutators are more vulnerable to &lt;strong&gt;Muller's ratchet&lt;/strong&gt; due to faster accumulation of deleterious mutations &lt;span class="citation"&gt;(Funchain et al. 2000)&lt;/span&gt;.&lt;/li&gt;
&lt;li&gt;Beneficial mutations can move to non-mutator background by horizontal gene transfer or back/compensatory mutation at the mutator locus.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Local mutators&lt;/strong&gt; - DNA sequences that induce high mutation rates in their neighborhoods - were found in virulent loci.&lt;/li&gt;
&lt;li&gt;There are over 20 loci associated with mutator phenotypes, probably with different direct effects on mutation rate and fitness and with different &lt;strong&gt;pleiotropic effects&lt;/strong&gt; - for example, &lt;em&gt;mutT&lt;/em&gt; increases the mutation and adaptation rate but also increases transcriptional error rate &lt;span class="citation"&gt;(Taddei, Hayakawa, et al. 1997)&lt;/span&gt;.&lt;/li&gt;
&lt;li&gt;MMR mutants are special because they also &lt;strong&gt;increase recombination rates&lt;/strong&gt; which can help in adaptation &lt;span class="citation"&gt;(Funchain et al. 2001)&lt;/span&gt;. High recombination rates can also help to restore non-mutator alleles after adaptation is complete&lt;sup&gt;&lt;a href="#fn4" class="footnoteRef" id="fnref4"&gt;4&lt;/a&gt;&lt;/sup&gt;.&lt;/li&gt;
&lt;li&gt;Most mutators were found in &lt;strong&gt;pathogenic bacteria&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Some mutators were correlated in natural populations with &lt;strong&gt;antibiotic resistance&lt;/strong&gt;, however not strong mutators: the latter are probably counter-selected after adaptation and are therefore not found in natural population &lt;span class="citation"&gt;(Taddei, Radman, et al. 1997)&lt;/span&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="references"&gt;References&lt;/h1&gt;
&lt;p&gt;Baquero, Mar&amp;#237;a-Rosario, Annika I. Nilsson, Mar&amp;#237;a del Carmen Turrientes, Dorthe Sandvang, Juan Carlos Gal&amp;#225;n, Jose Lu&amp;#237;s Mart&amp;#237;nez, Niels Frimodt-M&amp;#248; ller, Fernando Baquero, and Dan I. Andersson. 2004. &amp;#8220;Polymorphic Mutation Frequencies in Escherichia Coli: Emergence of Weak Mutators in Clinical Isolates.&amp;#8221; &lt;em&gt;Journal of Bacteriology&lt;/em&gt; 186 (16) (aug): 5538&amp;#8211;42. doi:10.1128/JB.186.16.5538-5542.2004. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=490890" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=490890"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=490890&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Boe, L., M. Danielsen, S. Knudsen, J. B. Petersen, J. Maymann, and P. R. Jensen. 2000. &amp;#8220;The Frequency of Mutators in Populations of Escherichia Coli.&amp;#8221; &lt;em&gt;Mutation Research&lt;/em&gt; 448 (1) (mar): 47&amp;#8211;55. doi:10.1016/S0027-5107(99)00239-0. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/10751622" title="http://www.ncbi.nlm.nih.gov/pubmed/10751622"&gt;http://www.ncbi.nlm.nih.gov/pubmed/10751622&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Dawson, Kevin J. 1998. &amp;#8220;Evolutionarily Stable Mutation Rates.&amp;#8221; &lt;em&gt;Journal of Theoretical Biology&lt;/em&gt; 194 (1) (sep): 143&amp;#8211;57. doi:10.1006/jtbi.1998.0752. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/9778430" title="http://www.ncbi.nlm.nih.gov/pubmed/9778430"&gt;http://www.ncbi.nlm.nih.gov/pubmed/9778430&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Denamur, Erick, and Ivan Matic. 2006. &amp;#8220;Evolution of Mutation Rates in Bacteria.&amp;#8221; &lt;em&gt;Molecular Microbiology&lt;/em&gt; 60 (4) (may): 820&amp;#8211;7. doi:10.1111/j.1365-2958.2006.05150.x. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/16677295" title="http://www.ncbi.nlm.nih.gov/pubmed/16677295"&gt;http://www.ncbi.nlm.nih.gov/pubmed/16677295&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Funchain, P., A. Yeung, J. Stewart, W. M. Clendenin, and J. H. Miller. 2001. &amp;#8220;Amplification of Mutator Cells in a Population as a Result of Horizontal Transfer.&amp;#8221; &lt;em&gt;Journal of Bacteriology&lt;/em&gt; 183 (12) (jun): 3737&amp;#8211;41. doi:10.1128/JB.183.12.3737-3741.2001. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=95251" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=95251"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=95251&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Funchain, Pauline, Annie Yeung, Jean Lee Stewart, Rose Lin, Malgorzata M. Slupska, and Jeffrey H. Miller. 2000. &amp;#8220;The Consequences of Growth of a Mutator Strain of Escherichia Coli as Measured by Loss of Function Among Multiple Gene Targets and Loss of Fitness.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 154 (3) (mar): 959&amp;#8211;70. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1461004" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1461004"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1461004&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Leigh, Egbert Giles. 1973. &amp;#8220;The Evolution of Mutation Rates.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 73 (apr): Suppl73:1&amp;#8211;18. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/4711556" title="http://www.ncbi.nlm.nih.gov/pubmed/4711556"&gt;http://www.ncbi.nlm.nih.gov/pubmed/4711556&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Matic, Ivan, Fran&amp;#231;ois Taddei, Bertrand Picard, Catherine Doit, Edouard Bingen, Erick Denamur, and Jacques Elion. 1997. &amp;#8220;Highly Variable Mutation Rates in Commensal and Pathogenic Escherichia Coli.&amp;#8221; &lt;em&gt;Science&lt;/em&gt; 277 (5333) (sep): 1833&amp;#8211;1834. doi:10.1126/science.277.5333.1833. &lt;a href="http://www.sciencemag.org/cgi/doi/10.1126/science.277.5333.1833" title="http://www.sciencemag.org/cgi/doi/10.1126/science.277.5333.1833"&gt;http://www.sciencemag.org/cgi/doi/10.1126/science.277.5333.1833&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Taddei, Fran&amp;#231;ois, H. Hayakawa, M. Bouton, A. Cirinesi, I. Matic, M. Sekiguchi, and M. Radman. 1997. &amp;#8220;Counteraction by MutT Protein of Transcriptional Errors Caused by Oxidative Damage.&amp;#8221; &lt;em&gt;Science&lt;/em&gt; 278 (5335) (oct): 128&amp;#8211;30. doi:10.1126/science.278.5335.128. &lt;a href="http://www.sciencemag.org/cgi/doi/10.1126/science.278.5335.128 http://www.ncbi.nlm.nih.gov/pubmed/9311918" title="http://www.sciencemag.org/cgi/doi/10.1126/science.278.5335.128 http://www.ncbi.nlm.nih.gov/pubmed/9311918"&gt;http://www.sciencemag.org/cgi/doi/10.1126/science.278.5335.128 http://www.ncbi.nlm.nih.gov/pubmed/9311918&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Taddei, Fran&amp;#231;ois, Miroslav Radman, John Maynard Smith, Bruno Toupance, Pierre-Henri Gouyon, and Bernard Godelle. 1997. &amp;#8220;Role of Mutator Alleles in Adaptive Evolution.&amp;#8221; &lt;em&gt;Nature&lt;/em&gt; 387 (6634) (jun): 700&amp;#8211;2. doi:10.1038/42696. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/9192893" title="http://www.ncbi.nlm.nih.gov/pubmed/9192893"&gt;http://www.ncbi.nlm.nih.gov/pubmed/9192893&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Torres-Barcel&amp;#243;, Clara, Gabriel Cabot, Antonio Oliver, Angus Buckling, and R. Craig Maclean. 2013. &amp;#8220;A Trade-off Between Oxidative Stress Resistance and DNA Repair Plays a Role in the Evolution of Elevated Mutation Rates in Bacteria.&amp;#8221; &lt;em&gt;Proceedings. Biological Sciences / The Royal Society&lt;/em&gt; 280 (1757) (jan): 20130007. doi:10.1098/rspb.2013.0007. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/23446530 http://datadryad.org/resource/doi:10.5061/dryad.jr4dc" title="http://www.ncbi.nlm.nih.gov/pubmed/23446530 http://datadryad.org/resource/doi:10.5061/dryad.jr4dc"&gt;http://www.ncbi.nlm.nih.gov/pubmed/23446530 http://datadryad.org/resource/doi:10.5061/dryad.jr4dc&lt;/a&gt;.&lt;/p&gt;
&lt;div class="footnotes"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn1"&gt;&lt;p&gt;Cost of DNA replication fidelity &lt;span class="citation"&gt;(Dawson 1998)&lt;/span&gt;&lt;a href="#fnref1"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn2"&gt;&lt;p&gt;Second-order selection (for example, &lt;span class="citation"&gt;(Leigh 1973)&lt;/span&gt;).&lt;a href="#fnref2"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn3"&gt;&lt;p&gt;But see &lt;span class="citation"&gt;(Torres-Barcel&amp;#243; et al. 2013)&lt;/span&gt; which showed that &lt;em&gt;P. aeruginosa&lt;/em&gt; mutators are oxidative-stress resistant.&lt;a href="#fnref3"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn4"&gt;&lt;p&gt;Rise and fall of the mutator allele &lt;span class="citation"&gt;(Taddei, Radman, et al. 1997)&lt;/span&gt;&lt;a href="#fnref4"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Summary: "Mutation rates: How low can you go?" (Sniegowski and Raynes 2013)</title>
    <id>http://blog.yoavram.com/sniegowski-raynes-2013/</id>
    <updated>2013-06-16T12:29:00Z</updated>
    <link href="http://blog.yoavram.com/sniegowski-raynes-2013/" />
    <author>
      <name></name>
    </author>
    <content type="html">
&lt;p&gt;This is a short summary of &lt;a href="http://www.sciencedirect.com/science/article/pii/S0960982213000213"&gt;Sniegowski and Raynes &lt;span class="citation"&gt;(2013)&lt;/span&gt;&lt;/a&gt;, a review about the evolution of the mutation rate, with an emphasis on the &lt;strong&gt;Drift Barrier Hypothesis&lt;/strong&gt; (DBH). The summary is written in my own words, with a few footnotes and highlighting that express my thoughts.&lt;/p&gt;
&lt;ol style="list-style-type: decimal"&gt;
&lt;li&gt;Because most mutations are deleterious, &lt;strong&gt;selection favors decreased mutation rates&lt;/strong&gt;&lt;sup&gt;&lt;a href="#fn1" class="footnoteRef" id="fnref1"&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;Then what keeps the mutation rate from dropping to &lt;em&gt;zero&lt;/em&gt;?&lt;/li&gt;
&lt;li&gt;One force &lt;em&gt;could&lt;/em&gt; be &lt;strong&gt;adaptive evolution&lt;/strong&gt; which creates selection for the generation of beneficial mutations.&lt;sup&gt;&lt;a href="#fn2" class="footnoteRef" id="fnref2"&gt;2&lt;/a&gt;&lt;/sup&gt; This selection, however, is limited &lt;span class="citation"&gt;(Sniegowski et al. 2000)&lt;/span&gt;.&lt;/li&gt;
&lt;li&gt;Another force can be the fitness cost of increasing genomic replication fidelity&lt;sup&gt;&lt;a href="#fn3" class="footnoteRef" id="fnref3"&gt;3&lt;/a&gt;&lt;/sup&gt;. This doesn't seem to solve the problem, mainly because although the cost of fidelity in prokaryotes should be higher than in eukaryotes, the genomic mutation rate is lower&lt;sup&gt;&lt;a href="#fn4" class="footnoteRef" id="fnref4"&gt;4&lt;/a&gt;&lt;/sup&gt;.&lt;/li&gt;
&lt;li&gt;There is also a physio-chemical constraint on the fidelity of replication and repair mechanisms&lt;sup&gt;&lt;a href="#fn5" class="footnoteRef" id="fnref5"&gt;5&lt;/a&gt;&lt;/sup&gt;. But this constraint should be similar to all species so it cannot explain the diversity.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DBH&lt;/strong&gt; &lt;span class="citation"&gt;(Sung, Ackerman, et al. 2012)&lt;/span&gt;: Reduction of the mutation rate has a diminishing effect on fitness&lt;sup&gt;&lt;a href="#fn6" class="footnoteRef" id="fnref6"&gt;6&lt;/a&gt;&lt;/sup&gt; and therefore at some point selection towards low mutation rates is weaker than drift. This effect is highly dependent on the &lt;strong&gt;population size&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&amp;quot;Drake's Rule&amp;quot;&lt;/strong&gt;: genomic mutation rates of DNA microbes&lt;sup&gt;&lt;a href="#fn7" class="footnoteRef" id="fnref7"&gt;7&lt;/a&gt;&lt;/sup&gt; are very similar (0.003 mutations per genome per generation) - the per base-pair mutation rate decreases with the genome size &lt;span class="citation"&gt;(Drake 1991)&lt;/span&gt;. This suggest a universal selective force which acts to adjust the mutation rate of microbes. This rule was recently tested and confirmed in &lt;em&gt;C. reinhardtii&lt;/em&gt; and &lt;em&gt;M. florum&lt;/em&gt; &lt;span class="citation"&gt;(Sung, Tucker, et al. 2012)&lt;/span&gt;, and it fits with the DBH, as microbes usually have very large populations.&lt;/li&gt;
&lt;li&gt;In contrast, in &lt;strong&gt;eukaryotes&lt;/strong&gt;, however, the per base-pair and genomic &lt;strong&gt;mutation rate increases with genome size&lt;/strong&gt;. This fits with the DBH, because eukaryotes presumebly have small effective population sizes.&lt;/li&gt;
&lt;li&gt;However, it is noted that both mutation rates and effective population sizes are very hard to measure and estimate.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="references"&gt;References&lt;/h1&gt;
&lt;p&gt;Dawson, Kevin J. 1998. &amp;#8220;Evolutionarily Stable Mutation Rates.&amp;#8221; &lt;em&gt;Journal of Theoretical Biology&lt;/em&gt; 194 (1) (sep): 143&amp;#8211;57. doi:10.1006/jtbi.1998.0752. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/9778430" title="http://www.ncbi.nlm.nih.gov/pubmed/9778430"&gt;http://www.ncbi.nlm.nih.gov/pubmed/9778430&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Drake, John W. 1991. &amp;#8220;A Constant Rate of Spontaneous Mutation in DNA-based Microbes.&amp;#8221; &lt;em&gt;Proceedings of the National Academy of Sciences of the United States of America&lt;/em&gt; 88 (16) (aug): 7160&amp;#8211;4. doi:10.1073/pnas.88.16.7160. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=52253" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=52253"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=52253&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Furi&amp;#243;, Victoria, Andr&amp;#233;s Moya, and Rafael Sanju&amp;#225;n. 2005. &amp;#8220;The Cost of Replication Fidelity in an RNA Virus.&amp;#8221; &lt;em&gt;Proceedings of the National Academy of Sciences of the United States of America&lt;/em&gt; 102 (29) (jul): 10233&amp;#8211;7. doi:10.1073/pnas.0501062102. &lt;a href="http://www.pnas.org/content/102/29/10233.short http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1177365\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract" title="http://www.pnas.org/content/102/29/10233.short http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1177365\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract"&gt;http://www.pnas.org/content/102/29/10233.short http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1177365\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Liberman, Uri, and Marcus W. Feldman. 1986. &amp;#8220;A General Reduction Principle for Genetic Modifiers of Recombination.&amp;#8221; &lt;em&gt;Theoretical Population Biology&lt;/em&gt; 30 (3) (dec): 341&amp;#8211;71. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/3810506" title="http://www.ncbi.nlm.nih.gov/pubmed/3810506"&gt;http://www.ncbi.nlm.nih.gov/pubmed/3810506&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Loh, Ern, Jesse J. Salk, and Lawrence A. Loeb. 2010. &amp;#8220;Optimization of DNA Polymerase Mutation Rates During Bacterial Evolution.&amp;#8221; &lt;em&gt;Proceedings of the National Academy of Sciences of the United States of America&lt;/em&gt; 107 (3) (jan): 1154&amp;#8211;9. doi:10.1073/pnas.0912451107. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2824296\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2824296\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2824296\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Machielsen, Ronnie, Ingrid J. van Alen-Boerrigter, Lucy A. Koole, Roger S. Bongers, Michiel Kleerebezem, and Johan E. T. Van Hylckama Vlieg. 2010. &amp;#8220;Indigenous and Environmental Modulation of Frequencies of Mutation in Lactobacillus Plantarum.&amp;#8221; &lt;em&gt;Applied and Environmental Microbiology&lt;/em&gt; 76 (5) (mar): 1587&amp;#8211;95. doi:10.1128/AEM.02595-09. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2832393\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2832393\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2832393\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sniegowski, Paul D., Philip J. Gerrish, Toby Johnson, and Aaron Shaver. 2000. &amp;#8220;The Evolution of Mutation Rates: Separating Causes From Consequences.&amp;#8221; &lt;em&gt;BioEssays : News and Reviews in Molecular, Cellular and Developmental Biology&lt;/em&gt; 22 (12) (dec): 1057&amp;#8211;66. doi:10.1002/1521-1878(200012)22:12&amp;lt;1057::AID-BIES3&amp;gt;3.0.CO;2-W. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/11084621" title="http://www.ncbi.nlm.nih.gov/pubmed/11084621"&gt;http://www.ncbi.nlm.nih.gov/pubmed/11084621&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sniegowski, Paul D., and Yevgeniy Raynes. 2013. &amp;#8220;Mutation Rates: How Low Can You Go?&amp;#8221; &lt;em&gt;Current Biology : CB&lt;/em&gt; 23 (4) (feb): R147&amp;#8211;9. doi:10.1016/j.cub.2013.01.018. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/23428322" title="http://www.ncbi.nlm.nih.gov/pubmed/23428322"&gt;http://www.ncbi.nlm.nih.gov/pubmed/23428322&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sung, Way, M. S. Ackerman, S. F. Miller, T. G. Doak, and Michael Lynch. 2012. &amp;#8220;Drift-barrier Hypothesis and Mutation-rate Evolution.&amp;#8221; &lt;em&gt;Proceedings of the National Academy of Sciences of the United States of America&lt;/em&gt; (oct). doi:10.1073/pnas.1216223109. &lt;a href="http://m.pnas.org/content/early/2012/10/17/1216223109.abstract?sid=675666f0-38c1-41f3-935b-dd6b0e6620cb" title="http://m.pnas.org/content/early/2012/10/17/1216223109.abstract?sid=675666f0-38c1-41f3-935b-dd6b0e6620cb"&gt;http://m.pnas.org/content/early/2012/10/17/1216223109.abstract?sid=675666f0-38c1-41f3-935b-dd6b0e6620cb&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sung, Way, Abraham E. Tucker, Thomas G. Doak, Eunjin Choi, W. Kelley Thomas, and Michael Lynch. 2012. &amp;#8220;Extraordinary Genome Stability in the Ciliate Paramecium Tetraurelia.&amp;#8221; &lt;em&gt;Proceedings of the National Academy of Sciences of the United States of America&lt;/em&gt; 109 (47) (nov): 19339&amp;#8211;44. doi:10.1073/pnas.1210663109. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/23129619" title="http://www.ncbi.nlm.nih.gov/pubmed/23129619"&gt;http://www.ncbi.nlm.nih.gov/pubmed/23129619&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Taddei, Fran&amp;#231;ois, Miroslav Radman, John Maynard Smith, Bruno Toupance, Pierre-Henri Gouyon, and Bernard Godelle. 1997. &amp;#8220;Role of Mutator Alleles in Adaptive Evolution.&amp;#8221; &lt;em&gt;Nature&lt;/em&gt; 387 (6634) (jun): 700&amp;#8211;2. doi:10.1038/42696. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/9192893" title="http://www.ncbi.nlm.nih.gov/pubmed/9192893"&gt;http://www.ncbi.nlm.nih.gov/pubmed/9192893&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Torres-Barcel&amp;#243;, Clara, Gabriel Cabot, Antonio Oliver, Angus Buckling, and R. Craig Maclean. 2013. &amp;#8220;A Trade-off Between Oxidative Stress Resistance and DNA Repair Plays a Role in the Evolution of Elevated Mutation Rates in Bacteria.&amp;#8221; &lt;em&gt;Proceedings. Biological Sciences / The Royal Society&lt;/em&gt; 280 (1757) (jan): 20130007. doi:10.1098/rspb.2013.0007. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/23446530 http://datadryad.org/resource/doi:10.5061/dryad.jr4dc" title="http://www.ncbi.nlm.nih.gov/pubmed/23446530 http://datadryad.org/resource/doi:10.5061/dryad.jr4dc"&gt;http://www.ncbi.nlm.nih.gov/pubmed/23446530 http://datadryad.org/resource/doi:10.5061/dryad.jr4dc&lt;/a&gt;.&lt;/p&gt;
&lt;div class="footnotes"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn1"&gt;&lt;p&gt;The reduction principle &lt;span class="citation"&gt;(Liberman and Feldman 1986)&lt;/span&gt;&lt;a href="#fnref1"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn2"&gt;&lt;p&gt;Second-order selection &lt;span class="citation"&gt;(Taddei et al. 1997; Machielsen et al. 2010)&lt;/span&gt;&lt;a href="#fnref2"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn3"&gt;&lt;p&gt;The cost of fidelity argument &lt;span class="citation"&gt;(Dawson 1998)&lt;/span&gt;&lt;a href="#fnref3"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn4"&gt;&lt;p&gt;AFAIK, this cost was mainly shown in viruses so far &lt;span class="citation"&gt;(Furi&amp;#243;, Moya, and Sanju&amp;#225;n 2005)&lt;/span&gt;, but a recent study did show some direct advantage of mutators which do not depend on replication fidelity &lt;em&gt;per se&lt;/em&gt; &lt;span class="citation"&gt;(Torres-Barcel&amp;#243; et al. 2013)&lt;/span&gt;&lt;a href="#fnref4"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn5"&gt;&lt;p&gt;However, anti-mutators do exist &lt;span class="citation"&gt;(Loh, Salk, and Loeb 2010)&lt;/span&gt;, so it seems that the mutation rate is not at its lower physio-chemical level.&lt;a href="#fnref5"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn6"&gt;&lt;p&gt;Why? Because, as we have seen in &lt;a href="/mean-fitness-at-the-mutation-selection-balance/"&gt;previous posts&lt;/a&gt;, the population mean fitness decays exponentialy as the genomic per generation mutation rate increases: &lt;span class="math"&gt;\(\bar{\omega} = e^{-U}\)&lt;/span&gt;.&lt;a href="#fnref6"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn7"&gt;&lt;p&gt;That is, not including RNA viruses.&lt;a href="#fnref7"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Summary: "Balancing robustness and evolvability" (Lenski et al. 2006)</title>
    <id>http://blog.yoavram.com/lenski-et-al-2006/</id>
    <updated>2013-06-16T10:46:00Z</updated>
    <link href="http://blog.yoavram.com/lenski-et-al-2006/" />
    <author>
      <name></name>
    </author>
    <content type="html">
&lt;p&gt;This is a summary of &lt;a href="http://www.plosbiology.org/article/info:doi/10.1371/journal.pbio.0040428"&gt;Lenski, Barrick and Ofria &lt;span class="citation"&gt;(2006)&lt;/span&gt;&lt;/a&gt;. The following are direct quotes of the original article. My comments are given as footnotes, highlighting and italics.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Organisms must have a &lt;strong&gt;balance between robustness and evolvability&lt;/strong&gt;, that is, between resisting and allowing change in their own internal states.&lt;/li&gt;
&lt;li&gt;A genome may be robust because it encodes &lt;em&gt;proofreading and repair systems&lt;/em&gt;&lt;sup&gt;&lt;a href="#fn1" class="footnoteRef" id="fnref1"&gt;1&lt;/a&gt;&lt;/sup&gt; that reduce replication errors or because it is organized such that many &lt;em&gt;mutations have little effect&lt;/em&gt;&lt;sup&gt;&lt;a href="#fn2" class="footnoteRef" id="fnref2"&gt;2&lt;/a&gt;&lt;/sup&gt; on its phenotype.&lt;/li&gt;
&lt;li&gt;We will focus on genomic robustness to mutations.&lt;/li&gt;
&lt;li&gt;Two mechanisms that could make a genome more robust are &lt;em&gt;genetic redundancy&lt;/em&gt;, so that many otherwise deleterious mutations are masked, and &lt;em&gt;proofreading during replication&lt;/em&gt;, so that fewer mutations occur.&lt;/li&gt;
&lt;li&gt;Evolution at &lt;strong&gt;low mutation rates&lt;/strong&gt; favors populations that achieve high fitness peaks, even if they are surrounded by steep cliffs, because mutations that push progeny off those cliffs are rare.&lt;/li&gt;
&lt;li&gt;At &lt;strong&gt;high mutation rates&lt;/strong&gt;, most offspring carry mutations, and selection favors populations that find lower fitness peaks surrounded by less precipitous mutational chasms.&lt;/li&gt;
&lt;li&gt;Environmental change is a pervasive feature of nature, and those physiological mechanisms that allow organisms to &lt;strong&gt;adjust to changing environments&lt;/strong&gt;, such as by regulating gene expression, will also compensate for the effects of many mutations.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Proofreading and repair must inhibit evolvability&lt;/strong&gt; because they reduce the production of new beneficial mutations.&lt;/li&gt;
&lt;li&gt;Are robustness and evolvability inversely correlated more generally? Robustness and evolvability might again be positively, rather than negatively, correlated.&lt;/li&gt;
&lt;li&gt;Redundancy can also promote adaptation by &lt;strong&gt;allowing duplicated genes to evolve distinct functions&lt;/strong&gt;&lt;sup&gt;&lt;a href="#fn3" class="footnoteRef" id="fnref3"&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;li&gt;Evolving populations can also become robust by finding regions of genotypic space that are flat because they contain a high proportion of neutral mutations.&lt;/li&gt;
&lt;li&gt;Deleterious mutations may lead to genetic neighborhoods that are more promising.&lt;/li&gt;
&lt;li&gt;One could ask how robustness and evolvability change depending on whether evolution occurs in &lt;strong&gt;constant or variable environments&lt;/strong&gt; &lt;span class="citation"&gt;(Meyers, Ancel, and Lachmann 2005)&lt;/span&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="license"&gt;License&lt;/h1&gt;
&lt;p&gt;The original paper was published in &lt;a href="http://www.plosbiology.org/"&gt;PLoS Biology&lt;/a&gt; under a CC-BY license.&lt;/p&gt;
&lt;h1 id="references"&gt;References&lt;/h1&gt;
&lt;p&gt;Lenski, Richard E., Jeffrey E. Barrick, and Charles Ofria. 2006. &amp;#8220;Balancing Robustness and Evolvability.&amp;#8221; &lt;em&gt;PLoS Biology&lt;/em&gt; 4 (12) (dec): e428. doi:10.1371/journal.pbio.0040428. &lt;a href="http://www.plosbiology.org/article/info:doi/10.1371/journal.pbio.0040428" title="http://www.plosbiology.org/article/info:doi/10.1371/journal.pbio.0040428"&gt;http://www.plosbiology.org/article/info:doi/10.1371/journal.pbio.0040428&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Meyers, Lauren Ancel, Fredric D. Ancel, and Michael Lachmann. 2005. &amp;#8220;Evolution of Genetic Potential.&amp;#8221; Ed. Eddie Holmes. &lt;em&gt;PLoS Computational Biology&lt;/em&gt; 1 (3) (aug): 236&amp;#8211;43. doi:10.1371/journal.pcbi.0010032. &lt;a href="http://dx.plos.org/10.1371/journal.pcbi.0010032" title="http://dx.plos.org/10.1371/journal.pcbi.0010032"&gt;http://dx.plos.org/10.1371/journal.pcbi.0010032&lt;/a&gt;.&lt;/p&gt;
&lt;div class="footnotes"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn1"&gt;&lt;p&gt;Low mutation rate (&lt;em&gt;U&lt;/em&gt;).&lt;a href="#fnref1"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn2"&gt;&lt;p&gt;Small mutation effect (&lt;em&gt;s&lt;/em&gt;).&lt;a href="#fnref2"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn3"&gt;&lt;p&gt;The amplification model.&lt;a href="#fnref3"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Creating PDFs with Pandoc</title>
    <id>http://blog.yoavram.com/creating-pdfs-with-pandoc/</id>
    <updated>2012-12-16T09:36:00Z</updated>
    <link href="http://blog.yoavram.com/creating-pdfs-with-pandoc/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#simple-pdf-rendering"&gt;Simple PDF rendering&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#with-bibliography"&gt;With bibliography&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#creating-epub"&gt;Creating EPUB&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#creating-pdfs-for-mobile-phones"&gt;Creating PDFs for mobile phones&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#sample-text-with-math-code-and-citation"&gt;Sample text with math, code and citation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a name='TOC'&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="overview"&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This post will show how to convert a &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt; document to PDF, mobile-PDF and EPUB documents using &lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt;. The guide is not exhastive but rather a walkthrough of my own experiments. The mobile-PDF especially is lacking - it is based on somewhat advanced &lt;span class="math"&gt;\(LaTeX\)&lt;/span&gt;, and I'm a novice user of that language.&lt;/p&gt;
&lt;p&gt;The source &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt; file use for this post, &lt;a href="https://gist.github.com/4305736/"&gt;creating-pdfs-with-pandoc.md&lt;/a&gt;, is available as a gist.&lt;/p&gt;
&lt;p&gt;For more on rendering citations in &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt; with &lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt;, see an &lt;a href="/citations-in-markdown-using-pandoc/"&gt;earlier post&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="simple-pdf-rendering"&gt;&lt;a href="#simple-pdf-rendering"&gt;Simple PDF rendering&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;&amp;gt; pandoc creating-pdfs-with-pandoc.md -o creating-pdfs-with-pandoc.pdf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href="https://www.box.com/s/sbsvcg28mnao4clscz5n"&gt;See result&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="with-bibliography"&gt;&lt;a href="#with-bibliography"&gt;With bibliography&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;&amp;gt; pandoc creating-pdfs-with-pandoc.md -o creating-pdfs-with-pandoc.pdf --bibliography=&amp;lt;path to bibtex file&amp;gt; [--csl=&amp;lt;path to csl file&amp;gt;] [--toc]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The CSL file is optional, if ommited &lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt; uses &lt;a href="http://www.chicagomanualofstyle.org/tools_citationguide.html"&gt;Chicago-style citations&lt;/a&gt;. You can find more information on citation styles at &lt;a href="http://citationstyles.org/"&gt;http://citationstyles.org/&lt;/a&gt;. If you add the &lt;code&gt;--toc&lt;/code&gt; option &lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt; will add a table of contents.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.box.com/s/3ct61opmejh76nn374ri"&gt;See result&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="creating-epub"&gt;&lt;a href="#creating-epub"&gt;Creating EPUB&lt;/a&gt;&lt;/h2&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;&amp;gt; pandoc creating-pdfs-with-pandoc.md -o creating-pdfs-with-pandoc.epub --bibliography=&amp;lt;path to bibtex file&amp;gt; [--csl=&amp;lt;path to csl file&amp;gt;] [--toc]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;On Windows 7 you can open EPUB files with &lt;a href="http://calibre-ebook.com"&gt;Calibre&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.box.com/s/vaebc1h0l823yfqh1a3w"&gt;See result&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="creating-pdfs-for-mobile-phones"&gt;&lt;a href="#creating-pdfs-for-mobile-phones"&gt;Creating PDFs for mobile phones&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This is following the discussion on &lt;a href="http://tex.stackexchange.com/questions/78920/generating-smartphone-readable-pdf"&gt;tex.stackexchange&lt;/a&gt;, and using a &lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt; latex template which merges the default template with &lt;a href="http://uweziegenhagen.de/?p=765"&gt;this one&lt;/a&gt;. Here is &lt;a href="https://gist.github.com/3979276/"&gt;the template as a gist&lt;/a&gt;. Remember to put the template in Pandoc's template folder (on Windows 7, C:\Program Files (x86)\Pandoc\templates).&lt;/p&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;&amp;gt; pandoc creating-pdfs-with-pandoc.md -o creating-pdfs-with-pandoc.iphone.pdf -s --template=iphone-pandoc-template.latex --bibliography=&amp;lt;path to bibtex file&amp;gt; [--csl=&amp;lt;path to csl file&amp;gt;] [--toc]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This rendering is &lt;strong&gt;not so good&lt;/strong&gt; - pages are split strangely and code segements are cropped. If anyone wants to play around with the &lt;a href="https://gist.github.com/3979276/"&gt;template&lt;/a&gt;, I'll be happy to post the results.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.box.com/s/82kjkhck9nf87kfha9b0"&gt;See result&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="sample-text-with-math-code-and-citation"&gt;&lt;a href="#sample-text-with-math-code-and-citation"&gt;Sample text with math, code and citation&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Here is a reference &lt;span class="citation"&gt;(Kimura and Maruyama 1966)&lt;/span&gt;, and also a link to my blog &lt;a href="http://blog.yoavram.com"&gt;Mutation-Selection Blog&lt;/a&gt;. Here's a footnote&lt;sup&gt;&lt;a href="#fn1" class="footnoteRef" id="fnref1"&gt;1&lt;/a&gt;&lt;/sup&gt; that you can see on the bottom.&lt;/p&gt;
&lt;p&gt;One of my favorite mathematical expressions is the &lt;a href="http://en.wikipedia.org/wiki/Triangle_inequality"&gt;triangle ineuqality&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\[
\forall{x,y} \; \|x + y\| \leq \|x\| + \|y\|
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And a piece of Python code:&lt;/p&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;for x in [p for p in posts if p[&amp;#39;author&amp;#39;] == &amp;#39;yoavram&amp;#39;]:
    print x[&amp;#39;date&amp;#39;]
print &amp;#39;done&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id="references"&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Kimura, Motoo, and Takeo Maruyama. 1966. &amp;#8220;The Mutational Load With Epistatic Gene Interactions in Fitness.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 54 (6) (dec): 1337&amp;#8211;51. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1211299" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1211299"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1211299&lt;/a&gt;.&lt;/p&gt;
&lt;div class="footnotes"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn1"&gt;&lt;p&gt;Footnotes are great.&lt;a href="#fnref1"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">The convergence of mean fitness towards the mutation-selection balance</title>
    <id>http://blog.yoavram.com/convergence-of-mean-fitness/</id>
    <updated>2012-11-19T13:49:00Z</updated>
    <link href="http://blog.yoavram.com/convergence-of-mean-fitness/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#motivation"&gt;Motivation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#model"&gt;Model&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#definitions"&gt;Definitions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#the-distribution-of-mutant-alleles"&gt;The distribution of mutant alleles&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#the-expected-number-of-mutant-alleles"&gt;The expected number of mutant alleles&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#the-population-mean-fitness"&gt;The population mean fitness&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#estimation-of-mutation-rates"&gt;Estimation of mutation rates&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#technical-remarks"&gt;Technical remarks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a name='TOC'&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="overview"&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In an &lt;a href="/mean-fitness-at-the-mutation-selection-balance/"&gt;eariler post&lt;/a&gt; I described how the mean fitness of a population at the &lt;em&gt;mutation-selection balance&lt;/em&gt; can be analysed. I assumed that the population is &lt;strong&gt;asexual&lt;/strong&gt;, that only &lt;strong&gt;deleterious mutations&lt;/strong&gt; occur, that there is &lt;strong&gt;no drift or recombination&lt;/strong&gt;, and that &lt;strong&gt;selection is constant&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;In this post I would like to continue with these assumpions. I will show how to find a &lt;strong&gt;simple formula for the mean fitness after an arbitrary number of generations&lt;/strong&gt;. The formulation and derivation will follow one of my favorite papers - &lt;a href="http://link.aps.org/doi/10.1103/PhysRevE.71.031907"&gt;&amp;quot;Nonequilibrium model for estimating parameters of deleterious mutations&amp;quot;&lt;/a&gt; by &lt;span class="citation"&gt;Gordo and Dionisio (2005)&lt;/span&gt;.&lt;/p&gt;
&lt;h2 id="motivation"&gt;&lt;a href="#motivation"&gt;Motivation&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;But first, why are we interested in the mean fitness of a population that is not at the mutation-selection balance?&lt;/p&gt;
&lt;p&gt;The general answer is that most populations are probably &lt;strong&gt;not&lt;/strong&gt; at the mutation-selection balance. The mutation-selection balance is a nice idea, but it serves as a reference, as a null hypothesis, not as a general rule. The assumption that selection is constant is not relevant to many populations - selection is probably fluctuating, both in amplitude and direction. This means that at least some of the natural populations we encounter in the wild are not evolving around a mutation-selection balance, but rather evolving towards a mutation-selection balance, never actually reaching one.&lt;/p&gt;
&lt;p&gt;The more specific answer is that even in laboratory conditions which induce a constant selection regime it may take a long time for populations to reach the mutation-selection balance, and this time might be longer than what we intuitively expect (or desire).&lt;/p&gt;
&lt;p&gt;This issue is presented by &lt;span class="citation"&gt;Gordo and Dionisio (2005)&lt;/span&gt;. They wanted to use traditional models for calculating the mutation rate of bacterial populations in the lab. These models assume that the populations are at a mutation-selection balance, but Gordo and Dionisio showed that in the timeframe they planned for their study their populations will not reach an equilibrium, especially if selection is weak (see Figure 1 in &lt;span class="citation"&gt;(Gordo and Dionisio 2005)&lt;/span&gt;).&lt;/p&gt;
&lt;p&gt;This is interesting, because we saw in the &lt;a href="/mean-fitness-at-the-mutation-selection-balance/"&gt;eariler post&lt;/a&gt; that the mean fitness at the mutation-selection balance is &lt;em&gt;e&lt;sup&gt;-U&lt;/sup&gt;&lt;/em&gt;, where &lt;em&gt;U&lt;/em&gt; is the mutation rate and is independent of &lt;em&gt;s&lt;/em&gt;, the selection coefficient. But Figure 1 in &lt;span class="citation"&gt;(Gordo and Dionisio 2005)&lt;/span&gt; shows that the mean fitness before the mutation-selection balance &lt;em&gt;is dependent&lt;/em&gt; on &lt;em&gt;s&lt;/em&gt;, and that &lt;em&gt;s&lt;/em&gt; determines the rate of convergence towards the balance.&lt;/p&gt;
&lt;h2 id="model"&gt;&lt;a href="#model"&gt;Model&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This follows the model from &lt;span class="citation"&gt;(Gordo and Dionisio 2005)&lt;/span&gt; but I elaborated and included all the rigouros steps.&lt;/p&gt;
&lt;h3 id="definitions"&gt;&lt;a href="#definitions"&gt;Definitions&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Denote the pmf (probability mass function) of a Poisson distribution with parameter &lt;span class="math"&gt;\(\lambda\)&lt;/span&gt;: &lt;span class="math"&gt;\(\varphi_{\lambda} (x)\)&lt;/span&gt; Consider an asexual infinite population evolving in a constant environment. The number of new mutations per individual per generation is Poisson distributed with parameter &lt;em&gt;U&lt;/em&gt;, the mutation rate. All mutations are deleterious with a multiplicative effect &lt;em&gt;s&lt;/em&gt;, so that an individual with &lt;span class="math"&gt;\(i\)&lt;/span&gt; mutant allele has a fitness &lt;span class="math"&gt;\(\omega_{i}:=(1-s)^{i}\)&lt;/span&gt; with selection coefficient &lt;span class="math"&gt;\(0&amp;lt;s&amp;lt;1\)&lt;/span&gt;. The frequency of individuals with &lt;em&gt;i&lt;/em&gt; mutant at generation &lt;em&gt;g&lt;/em&gt; is denoted &lt;span class="math"&gt;\(f_{i}(g)\)&lt;/span&gt; and &lt;span class="math"&gt;\(\sum_{i}{f_{i}(g)}=1\)&lt;/span&gt;. From the former two statements it follows that the population mean fitness at generation &lt;em&gt;g&lt;/em&gt; is &lt;span class="math"&gt;\(\bar{\omega }_{g}=\sum_{i}{f_{i}(g)\omega _{i}}\)&lt;/span&gt;. Assume that the selection occurs before mutation.&lt;/p&gt;
&lt;h3 id="the-distribution-of-mutant-alleles"&gt;&lt;a href="#the-distribution-of-mutant-alleles"&gt;The distribution of mutant alleles&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The change in the frequency of individuals with &lt;em&gt;i&lt;/em&gt; mutant alleles from generation &lt;em&gt;g&lt;/em&gt; to generation &lt;em&gt;g+1&lt;/em&gt; is written as:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\[
f_{i}(g+1)=\sum_{k=0}^{i}{\frac{ \omega _{k} }{ \bar{\omega}_{g} } f_{k}(g) \varphi_{U} (i-k) }
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The model starts with a mutation-free population, so the initial condition is &lt;span class="math"&gt;\(f_{0}(0)=1, f_{i&amp;gt;0}(0)=0\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Let's calculate the frequency of individuals with &lt;em&gt;i&lt;/em&gt; mutant alleles after one generation:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\[
f_{i}(1)=\sum_{k=0}^{i}{f_{k}(0)\frac{\omega _{k}}{\bar{\omega}_{1}}\cdot \frac{U^{i-k}}{(i-k)!}e^{-U}}
\]&lt;/span&gt; and because &lt;span class="math"&gt;\[
f_{k}(0)=\bigg\{
\begin{gathered}
1, k=0 \\
0, otherwise \\
\end{gathered}
\]&lt;/span&gt; we get &lt;span class="math"&gt;\[
f_{i}(1) = f_{0}(0)\frac{\omega _{0}}{\bar{\omega }_{1}} \cdot \frac{U^{i}}{i!}e^{-U} = \frac{U^{i}}{i!}e^{-U}
\]&lt;/span&gt; so the frequency of individuals with &lt;em&gt;i&lt;/em&gt; mutant alleles after one generation is Poisson distributed with parameter &lt;em&gt;U&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;To verify this - the expected number of mutations after one generation is &lt;span class="math"&gt;\[
\sum_{i\ge 0}{i\cdot f_{i}(1)} = \sum_{i\ge 1}{i\cdot \frac{U^{i}}{i!}e^{-U}} =\\ 
e^{-U}U\sum_{i\ge 1}{\frac{U^{i-1}}{(i-1)!}} = \\ 
e^{-U}U\sum_{i\ge 0}{\frac{U^{i}}{i!}} = \\ 
Ue^{-U}e^{U} = U
\]&lt;/span&gt; as expected.&lt;/p&gt;
&lt;p&gt;To go on the next step, we will find the frequency of individuals with &lt;em&gt;i&lt;/em&gt; mutant alleles at the second generation, after selection but &lt;em&gt;before&lt;/em&gt; mutations - this is marked by &lt;span class="math"&gt;\(f_{i}^{s}(2)\)&lt;/span&gt;: &lt;span class="math"&gt;\[
f_{i}^{s}(2) = \frac{\omega _{i}}{\bar{\omega}_{1}}f_{i}(1) = \\
\frac{(1-s)^{i}}{\sum_{k=0}^{\infty }{f_{k}(1)\omega_{k}}}\frac{U^{i}}{i!}e^{-U} = \\
\frac{(1-s)^{i}}{\sum_{k=0}^{\infty}{\frac{U^{k}}{k!}e^{-U}(1-s)^{k}}}\frac{U^{i}}{i!}e^{-U} = \\
\frac{(U(1-s))^{i}}{i!\sum_{k=0}^{\infty}{\frac{(U(1-s))^{k}}{k!}}} = \\
\frac{(U(1-s))^{i}}{i!}e^{-U(1-s)}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So, &lt;span class="math"&gt;\(f_{i}^{s}(2)\)&lt;/span&gt; is Poisson distributed with parameter &lt;span class="math"&gt;\(U(1-s)\)&lt;/span&gt;, and the frequency &lt;em&gt;after&lt;/em&gt; mutation will be: &lt;span class="math"&gt;\[
f_{i}(2) = \sum_{k=0}^{i}{f_{k}^{s}(2)\frac{U^{i-k}}{(i-k)!}e^{-U}} = \\
\sum_{k=0}^{i}{\frac{(U(1-s))^{k}}{k!}e^{-U(1-s)}\frac{U^{i-k}}{(i-k)!}e^{-U}} = \\
e^{-U(1-s)-U}\sum_{k=0}^{i}{\frac{U^{i-k}(U(1-s))^{k}}{k! \cdot (i-k)!}} = \\
\frac{U^{i}}{e^{U(1-s) + U}} \sum_{k=0}^{i}{\frac{(U(1-s))^{k}}{U^{k} \cdot k! \cdot (i-k)!}} = \\
\frac{U^{i}}{e^{U(1-s) + U}} \sum_{k=0}^{i}{\frac{(1-s)^{k}}{k! \cdot (i-k)!}}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Note that &lt;span class="math"&gt;\(\sum_{k=0}^{i}{\frac{q^{k}}{k!\cdot (i-k)! }} = \frac{(q+1)^{i}}{i!}\)&lt;/span&gt; And &lt;span class="math"&gt;\(\sum_{k=1}^{i}{\frac{q^{k}}{k!\cdot (i-k)! }}=\frac{(q+1)^{i}-1}{i!}\)&lt;/span&gt;, and therefore:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\[
f_{i}(2) = \frac{U^{i}}{e^{U(1-s)+U}}\cdot \frac{(2-s)^{i}}{i!} = \\
\frac{(U(1-s)+U)^{i}}{i!}e^{-(U(1-s)+U)} = \\
\phi(i | U(1-s)+U)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Similar to the former expansion and because the Poisson process is &lt;em&gt;memoryless&lt;/em&gt;, the frequency of individuals with &lt;em&gt;i&lt;/em&gt; mutant alleles after mutation at generation 2 will be Poisson distributed with parameter &lt;span class="math"&gt;\(U(1-s)+U\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The same argument makes it clear that the distribution of mutant alleles at any generation &lt;em&gt;g&lt;/em&gt; is Poisson distributed, but let's see a rigrouros formulation of this.&lt;/p&gt;
&lt;h2 id="the-expected-number-of-mutant-alleles"&gt;&lt;a href="#the-expected-number-of-mutant-alleles"&gt;The expected number of mutant alleles&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;After seeing how the distribution of mutant alleles changes at the first couple of generations, and verifying that this is a Poisson distribution, we can now formulate the recurrence relation for the expected number of mutatnt allele - or the parameter of the Poisson distribution, &lt;span class="math"&gt;\(\lambda\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\[
\lambda (g+1) = \sum_{k=0}^{\infty }{k\cdot f_{k}(g+1)} = \\
\sum_{k=0}^{\infty}{\sum_{i=0}^{k}{k\frac{(1-s)^{i}}{\bar{\omega}_{g}}f_{i}(g)\frac{U^{k-i}}{(k-i)!}e^{-U}}} = \\
\sum_{i=0}^{\infty}{\sum_{k=i}^{\infty }{k\frac{(1-s)^{i}}{\bar{\omega}_{g}}f_{i}(g)\frac{U^{k-i}}{(k-i)!}e^{-U}}} = \\
\sum_{i=0}^{\infty}{e^{-U}\frac{(1-s)^{i}}{\bar{\omega}_{g}}U^{-i}f_{i}(g)\sum_{k=i}^{\infty}{k\frac{U^{k}}{(k-i)!}}} = \\
\sum_{i=0}^{\infty}{e^{-U}\frac{(1-s)^{i}}{\bar{\omega}_{g}}U^{-i}f_{i}(g)e^{U}U^{i}(i+U)} = \\
\frac{1}{\bar{\omega}_{g}}\sum_{i=0}^{\infty }{f_{i}(g)(1-s)^{i}(i+U)} = \\
\frac{U}{\bar{\omega}_{g}}\sum_{i=0}^{\infty }{f_{i}(g)(1-s)^{i}}+\frac{1}{\bar{\omega}_{g}}\sum_{i=1}^{\infty }{i\cdot f_{i}(g)(1-s)^{i}} = \\
U + \frac{\sum_{i=1}^{\infty }{i\cdot f_{i}(g)(1-s)^{i}}}{\sum_{i=0}^{\infty}{f_{i}(g)(1-s)^{i}}} = \\
U + \frac{\sum_{i=1}^{\infty }{i\cdot \frac{e^{\lambda (g)}(\lambda (g)(1-s))^{i}}{i!}}}{\sum_{i=0}^{\infty}{\frac{e^{\lambda(g)}(\lambda (g)(1-s))^{i}}{i!}}} = \\
U + \frac{\lambda(g)(1-s)\cdot e^{\lambda (g)(1-s)}}{e^{\lambda(g)(1-s)}} = \\
\lambda (g)(1-s) + U
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So we got a nice recurrence formula - &lt;span class="math"&gt;\(\lambda (g+1)=\lambda (g)(1-s)+U\)&lt;/span&gt; with an initial condition &lt;span class="math"&gt;\(\lambda (1)=U\)&lt;/span&gt;. The recurrence means that the expected number of mutatnt alleles per individual in the population is reduced every generation by selection by multiplying it by &lt;em&gt;(1-s)&lt;/em&gt; and increased by mutation by adding &lt;em&gt;U&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The solution to this recurrence relation is (why? this will require another post): &lt;span class="math"&gt;\[
\lambda(g)=\frac{U}{s}(1-(1-s)^{g})\xrightarrow{g\to \infty }\frac{U}{s}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;For a sinlge-locus deterministic model, the expected frequency of the wild-type allele at the mutation-selection balance (assuming that &lt;span class="math"&gt;\(s&amp;gt;&amp;gt;U\)&lt;/span&gt;) is &lt;span class="math"&gt;\(1 - \frac{U}{s}\)&lt;/span&gt;, which agrees well with the frequency of mutation-free individuals we can now calculate: &lt;span class="math"&gt;\(\phi(0 | \frac{U}{s}) = \frac{\frac{U}{s}^0}{0!} e^{-\frac{U}{s}} = e^{-\frac{U}{s}} = 1-\frac{U}{s} + O(\frac{U}{s}^{2})\)&lt;/span&gt;. The last approximation uses the Taylor expansion of the exponential function around 0.&lt;/p&gt;
&lt;h2 id="the-population-mean-fitness"&gt;&lt;a href="#the-population-mean-fitness"&gt;The population mean fitness&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;After &lt;em&gt;g&lt;/em&gt; generations the population mean fitness is:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\[
\bar{\omega}_{g} = \sum_{i=0}^{\infty }{\frac{\lambda(g)^{i}}{i!}e^{-\lambda(g)}(1-s)^{i}} = \\ 
e^{-\lambda(g)}\sum_{i=0}^{\infty}{\frac{ (\lambda(g) (1-s))^{i}}{i!}} = \\
e^{-\lambda(g)}e^{\lambda(g)(1-s)} \Rightarrow \\
\bar{\omega}_{g} = e^{-\lambda(g) s}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Which gives us yet [another way][earlier post] to calculate the mean fitness at the mutation-selection balance: &lt;span class="math"&gt;\[
\bar{\omega }^* = lim_{g\to \infty} e^{-\lambda(g) s} = e^{-\frac{U}{s}s} = e^{-U}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The second moment of the population fitness is given by:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\[
E[\omega_{g}^2] = \sum_{i=0}^{\infty }{\frac{\lambda(g)^{i}}{i!}e^{-\lambda(g)}(1-s)^{2i}} = \\
e^{-\lambda(g)} \sum_{i=0}^{\infty }{\frac{ (\lambda(g)(1-s)^2)^{i} }{i!}} = \\
e^{-\lambda(g)} e^{\lambda(g)(1-s)^2} = \\
e^{\lambda(g)(1-2s+s^2)-\lambda(g)} = \\
e^{\lambda(g)(s^2-2s)}
\]&lt;/span&gt;&lt;/p&gt;
&lt;h2 id="estimation-of-mutation-rates"&gt;&lt;a href="#estimation-of-mutation-rates"&gt;Estimation of mutation rates&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In mutation-accumulation (MA) experiments, a population is undergoing a sequence of bottlenecks that cause the accumulation of deleterious mutations due to the random sampling effect of &lt;strong&gt;genetic drift&lt;/strong&gt;. In these experiments the investigators usually measure the mean fitness of the experimental population thorugh time and use these measurements to estimate &lt;em&gt;s&lt;/em&gt; and &lt;em&gt;U&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Denote the expected mean fitness at bottleneck &lt;em&gt;B&lt;/em&gt; by &lt;span class="math"&gt;\(\bar{\omega{B}}\)&lt;/span&gt;. We start with a mutation-free population, and &lt;span class="math"&gt;\(\bar{\omega_{0}} = 1\)&lt;/span&gt;. At the first bottleneck, the population is assumed to reach a mutation-selection balance, so the expected mean fitness is now &lt;span class="math"&gt;\(\bar{\omega_{1}} = e^{-U}\)&lt;/span&gt;. At the next bottleneck, the expected mean fitness is reduced again by the same factor, so it is now &lt;span class="math"&gt;\(\bar{\omega_{1}} = e^{-U}e^{-U} = e^{-2U}\)&lt;/span&gt;. After &lt;em&gt;B&lt;/em&gt; bottlenecks, the mean fitness is &lt;span class="math"&gt;\(\bar{\omega_{B}} = e^{-UB}\)&lt;/span&gt;. So one can take the log of the measured mean fitness after &lt;em&gt;B&lt;/em&gt; bottlenecks, &lt;span class="math"&gt;\(-BU\)&lt;/span&gt;, and use a linear regression model to estimate &lt;em&gt;U&lt;/em&gt;. By using a similar linear regression on the ratio of the second moment of fitness and the square of the expected mean fitness, one can estimate &lt;em&gt;s&lt;/em&gt; (see below).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;However, what happens if the population doesn't reach a mutation-selection balance?&lt;/strong&gt; In a population of bacteria, for example, the number of generations between bottlenecks may be insufficient for the population to reach a mutation-selection balance (see Figure 1 in &lt;span class="citation"&gt;(Gordo and Dionisio 2005)&lt;/span&gt;). In this case one must use a the non-equilibrium value of the mean fitness which was derived above - &lt;span class="math"&gt;\(\bar{\omega}_{g} = e^{-\frac{U}{s} (1-(1-s)^{g})}\)&lt;/span&gt;. This concept is the subject of the paper by &lt;span class="citation"&gt;Gordo and Dionisio (2005)&lt;/span&gt;, titled: &lt;strong&gt;Nonequilibrium model for estimating parameters of deleterious mutations&lt;/strong&gt;. The paper explores a statistical model based on the above calculations. The statistical model is tested with simulations. In a later paper, &lt;span class="citation"&gt;(Trindade, Perfeito, and Gordo 2010)&lt;/span&gt;&lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2871818"&gt;trindade2010&lt;/a&gt;, the statistical model was used on results of a mutation-accumulation experiment with &lt;em&gt;E. coli&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;In the above development, we saw that the expected mean fitness after &lt;em&gt;g&lt;/em&gt; generations is &lt;span class="math"&gt;\(\bar{\omega}_{g} = e^{-\lambda(g) s}\)&lt;/span&gt;. If the number of generations between bottlenecks is constant, say &lt;em&gt;g=24&lt;/em&gt; (for a population in which a generation is estimated at 30 minutes, resulting in a bottleneck period of 12 hours), then we can denote &lt;span class="math"&gt;\(\lambda {:=} \lambda(g)\)&lt;/span&gt; and use &lt;span class="math"&gt;\(\bar{\omega_{B}} = e^{-\lambda s B}\)&lt;/span&gt;. Then we can use a linear regression model to estimate &lt;span class="math"&gt;\(-\lambda s\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;But how do we proceed? The estimator we found using linear regression, &lt;span class="math"&gt;\(\lambda s= \lambda(g) s = U(1-(1-s)^{g})\)&lt;/span&gt;, doesn't directly yield either &lt;em&gt;U&lt;/em&gt; or &lt;em&gt;s&lt;/em&gt;. Well, this is why we calculated the second moment. We will not use it directly, but instead define an F-statistic (not to be confused with the F-statistic used to describe heterozigosity or population structuring): &lt;span class="math"&gt;\(F_{B} = \frac{\bar{\omega^2}}{\bar{\omega}^2}\)&lt;/span&gt;. This is a little confusing so I'll write it in a probablistic presentation:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\[
F_{B} = \frac{E[\omega^2]}{E^2[\omega]}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This is the ratio of the second moment to the square of the first moment. What is this ratio? Let's have a look:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\[
F_{B} = \frac{E[\omega^2]}{E^2[\omega]} = \\
\frac{e^{\lambda (s^2-2s) B}}{e^{-2 \lambda s B}} =\\
e^{( \lambda s^2-2\lambda s+2 \lambda s)B} = \\
e^{( \lambda s^2)B}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So the log of the &lt;em&gt;F-statistic&lt;/em&gt; is &lt;span class="math"&gt;\(\lambda s^2 B\)&lt;/span&gt;, and linear regression can give us &lt;span class="math"&gt;\(\lambda s^2\)&lt;/span&gt;. Now we can estimate both &lt;em&gt;s&lt;/em&gt; and &lt;em&gt;U&lt;/em&gt; using the estimation for &lt;span class="math"&gt;\(-\lambda s\)&lt;/span&gt;, &lt;span class="math"&gt;\(\lambda s^2\)&lt;/span&gt;, and the relation &lt;span class="math"&gt;\(\lambda = \frac{U}{s}(1-(1-s)^g)\)&lt;/span&gt;.&lt;/p&gt;
&lt;h2 id="technical-remarks"&gt;&lt;a href="#technical-remarks"&gt;Technical remarks&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I originally wrote this post with &lt;a href="http://en.wikipedia.org/wiki/Microsoft_Office_2010"&gt;Office 2010&lt;/a&gt;. I converted it TeX using &lt;a href="http://docx2tex.codeplex.com/"&gt;docx2tex&lt;/a&gt; and from &lt;a href="http://en.wikipedia.org/wiki/LaTeX"&gt;TeX&lt;/a&gt; to &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt; using &lt;a href="https://github.com/ajtulloch/LaTeX2Markdown"&gt;LaTeX2Markdown&lt;/a&gt;, although it can also be sone using &lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt;. Then I proof-read it, and several LaTeX bugs were identified and fixed using an online tool for &lt;a href="http://www.onemathematicalcat.org/MathJaxDocumentation/TeXSyntax.htm"&gt;testing MathJax code&lt;/a&gt; (&lt;a href="http://www.mathjax.org/"&gt;MathJax&lt;/a&gt; is a JavaScript library that displays LaTeX in browsers, see how in &lt;a href="/blogging-with-math-and-code"&gt;another post&lt;/a&gt;).&lt;/p&gt;
&lt;h2 id="references"&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Gordo, Isabel, and Francisco Dionisio. 2005. &amp;#8220;Nonequilibrium Model for Estimating Parameters of Deleterious Mutations.&amp;#8221; &lt;em&gt;Physical Review E&lt;/em&gt; 71 (3) (mar): 18&amp;#8211;21. doi:10.1103/PhysRevE.71.031907. &lt;a href="http://link.aps.org/doi/10.1103/PhysRevE.71.031907" title="http://link.aps.org/doi/10.1103/PhysRevE.71.031907"&gt;http://link.aps.org/doi/10.1103/PhysRevE.71.031907&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Trindade, Sandra, Lilia Perfeito, and Isabel Gordo. 2010. &amp;#8220;Rate and Effects of Spontaneous Mutations That Affect Fitness in Mutator Escherichia Coli.&amp;#8221; &lt;em&gt;Philosophical Transactions of the Royal Society B: Biological Sciences&lt;/em&gt; 365 (1544) (apr): 1177&amp;#8211;86. doi:10.1098/rstb.2009.0287. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2871818" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2871818"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2871818&lt;/a&gt;.&lt;/p&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Summary: "Mutators and sex in bacteria: Conflict between adaptive strategies" (Tenaillon et al. 2000)</title>
    <id>http://blog.yoavram.com/tenaillon-et-al-2000/</id>
    <updated>2012-10-16T13:22:00Z</updated>
    <link href="http://blog.yoavram.com/tenaillon-et-al-2000/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#model"&gt;Model&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#genome"&gt;Genome&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#recombination"&gt;Recombination&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#parameters"&gt;Parameters&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#stats"&gt;Stats&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#results"&gt;Results&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#recombination-reduces-mutator-fixation"&gt;Recombination reduces mutator fixation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#recombination-barriers"&gt;Recombination barriers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#invasion-to-a-moderate-mutator-background"&gt;Invasion to a moderate mutator background&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#recombination-accelarates-adaptation"&gt;Recombination accelarates adaptation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#discussion"&gt;Discussion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a name='TOC'&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="overview"&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This post is mostly a technical summary of the paper by &lt;strong&gt;&lt;a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC27047/"&gt;Tenaillon, Le Nagard, Godelle and Taddei &lt;span class="citation"&gt;(2000)&lt;/span&gt;&lt;/a&gt;&lt;/strong&gt;. I wrote the summary because I use it as a baseline for my own research, which involves the evolution of stress-induced mutators &lt;span class="citation"&gt;(Ram and Hadany 2012)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The hypothesis the paper deals with is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;The existence of genetic exchanges could modify the dynamics of adaptation and limits the success of mutator alleles&lt;sup&gt;&lt;a href="#fn1" class="footnoteRef" id="fnref1"&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;It is stated that previous models &lt;span class="citation"&gt;(Leigh 1973; Johnson 1999)&lt;/span&gt; have considered mutators in a sexual population, but didn't consider the case of adaptation with &lt;strong&gt;multiple beneficial mutations&lt;/strong&gt; - which can involve different &lt;em&gt;Hill-Robertosn effects&lt;/em&gt; &lt;span class="citation"&gt;(Hill and Robertson 1966)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;This hypothesis was tested using simulations. The main conclusion, in comparison to a previous work in which the authors studies the evolution of mutators &lt;span class="citation"&gt;(Tenaillon et al. 1999)&lt;/span&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Rare genetic exchanges have a dramatic (i.e. negative) effect on the fixation of mutators.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In addition, the paper presents some evidence on &lt;em&gt;why&lt;/em&gt; genetic exchanges (recombination) have such an effect of the evolution of mutators.&lt;/p&gt;
&lt;h2 id="model"&gt;&lt;a href="#model"&gt;Model&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The model is an extension of the density-based model&lt;sup&gt;&lt;a href="#fn2" class="footnoteRef" id="fnref2"&gt;2&lt;/a&gt;&lt;/sup&gt; used in &lt;span class="citation"&gt;(Tenaillon et al. 1999)&lt;/span&gt;. The extension is the addition of genetic exchanges (&amp;quot;bacterial recombination&amp;quot;). Both &lt;strong&gt;conjugation&lt;/strong&gt; and &lt;strong&gt;transformation&lt;/strong&gt; were used, but only the results of transformation are shown.&lt;/p&gt;
&lt;p&gt;The model is built using:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Finite populations - genetic drift, clonal interference&lt;/li&gt;
&lt;li&gt;Directional selection - no epistasis, no changing environments&lt;/li&gt;
&lt;li&gt;Several mutations with various fitness effects&lt;/li&gt;
&lt;li&gt;Colonization of a new environment by a single cell - adaptive evolution scenario&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="genome"&gt;&lt;a href="#genome"&gt;Genome&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The basic model of the genome (in parentheses are the values used in my own work for comparison):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1 mutator locus (1)&lt;/li&gt;
&lt;li&gt;6 loci for beneficial mutations (4+)
&lt;ul&gt;
&lt;li&gt;with additive effect on fitness: 0.06, 0.04, 0.04, 0.03, 0.03, 0.03 - mean 0.03833 (0.1)&lt;/li&gt;
&lt;li&gt;all loci treated independently, only one locus will be involved in the process at one time (?)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;1,000 loci for deleterious mutations (+-1,000)
&lt;ul&gt;
&lt;li&gt;with additive effect on fitness: 0.05 (0.1)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="recombination"&gt;&lt;a href="#recombination"&gt;Recombination&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Drawing the number of recieved genes from a &lt;em&gt;Poisson&lt;/em&gt; distribution&lt;/li&gt;
&lt;li&gt;Randomly choose the sites, according to the number of sites drawn&lt;/li&gt;
&lt;li&gt;Choosing a random allele for each site based on the allele frequency in the population&lt;/li&gt;
&lt;li&gt;Constant gene transfer rate&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="parameters"&gt;&lt;a href="#parameters"&gt;Parameters&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Rates are modified from the original to units of &lt;em&gt;events per genome per generation&lt;/em&gt;. (in parentheses are the rates used in my own work for comparison):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mutators increase rates: 100-fold (2-10)&lt;/li&gt;
&lt;li&gt;Beneficial mutations: 6x10&lt;sup&gt;-8&lt;/sup&gt; based on 10&lt;sup&gt;-8&lt;/sup&gt; per mutation (1.2x10&lt;sup&gt;-5&lt;/sup&gt; - 3x10&lt;sup&gt;-5&lt;/sup&gt; - x200)&lt;/li&gt;
&lt;li&gt;Deleterious mutations: 10&lt;sup&gt;-4&lt;/sup&gt; &lt;span class="citation"&gt;(Kibota and Lynch 1996)&lt;/span&gt; (3x10&lt;sup&gt;-3&lt;/sup&gt; - 2.97x10&lt;sup&gt;-3&lt;/sup&gt; &lt;span class="citation"&gt;(Drake 1991)&lt;/span&gt;- x30)&lt;/li&gt;
&lt;li&gt;Lethal mutations: 10&lt;sup&gt;-5&lt;/sup&gt; (0)&lt;/li&gt;
&lt;li&gt;Non-mutator to mutator: 5x10&lt;sup&gt;-6&lt;/sup&gt; (0)&lt;/li&gt;
&lt;li&gt;Mutator to non-mutator: 100x5x10&lt;sup&gt;-10&lt;/sup&gt; = 5x10&lt;sup&gt;-8&lt;/sup&gt; (0)&lt;/li&gt;
&lt;li&gt;Genetic exchanges: 0, 0.00001, 0.0001, 0.001, 0.01 and 0.1 (0, 0.015 or 0.75)
&lt;ul&gt;
&lt;li&gt;For comparison, &lt;em&gt;E. coli&lt;/em&gt; do ~5x10&lt;sup&gt;-5&lt;/sup&gt; and &lt;em&gt;H. pylori&lt;/em&gt; ~3x10&lt;sup&gt;-3&lt;/sup&gt; &lt;span class="citation"&gt;(Milkman and Bridges 1990; Falush et al. 2001)&lt;/span&gt;.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Population size: mostly 10&lt;sup&gt;9&lt;/sup&gt;, also checked 10&lt;sup&gt;5&lt;/sup&gt;-10&lt;sup&gt;10&lt;/sup&gt; (10&lt;sup&gt;5&lt;/sup&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="stats"&gt;&lt;a href="#stats"&gt;Stats&lt;/a&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Time of adaptation: no. generations for 95% of population to carry all beneficial mutations&lt;/li&gt;
&lt;li&gt;Mutator frequency: mean frequency at end of adaptation process over 1,000 replicates&lt;/li&gt;
&lt;li&gt;Mutator contribution: when mutator frequency &amp;lt; 50% but at least one mutation that appeared in a mutator is present in &amp;gt;50% of population&lt;/li&gt;
&lt;li&gt;Mutator fixation: frequency &amp;gt;50%&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="results"&gt;&lt;a href="#results"&gt;Results&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="recombination-reduces-mutator-fixation"&gt;&lt;a href="#recombination-reduces-mutator-fixation"&gt;Recombination reduces mutator fixation&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;When the rate of genetic exchanges increases, the fixation probability of mutators decreases. &lt;em&gt;Figure 1A&lt;/em&gt; shows this very clearly for a 100-fold mutator:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC27047/figure/F1/"&gt;&lt;img src="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC27047/bin/pq1800633001.jpg" alt="Figure 1" /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Figure 1 from @Tenaillon2000a. A) Fixation probability of a 100-fold fold mutator, population size 10^-9. B) Adaptation times of populations with: circle - low mutation rate, square - high mutation rate, triangle - mixed populations.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;However, the &lt;em&gt;B panel&lt;/em&gt; shows that the adaptation time of a mutator population is still shorter than that of a non-mutator population, even when mutators are loosing. This is due to the contribution of mutators to adaptation - in a recombining population mutators are &lt;strong&gt;&amp;quot;altruistic&amp;quot;&lt;/strong&gt; alleles because they give away the beneficial mutations they generate. This causes them to lose their adaptive advantage and therefore their fixation probability drops, but it still increases the ability of the whole population to adapt.&lt;/p&gt;
&lt;p&gt;Note that the rates of recombination in the figure are &lt;em&gt;per gene&lt;/em&gt;. Converted to &lt;em&gt;per genome&lt;/em&gt; they would be: 0, 10&lt;sup&gt;-5&lt;/sup&gt;, 10&lt;sup&gt;-4&lt;/sup&gt;, 10&lt;sup&gt;-3&lt;/sup&gt;, 10&lt;sup&gt;-2&lt;/sup&gt;, 10&lt;sup&gt;-1&lt;/sup&gt;, or in decimal representation: 0, 0.00001, 0.0001, 0.001, 0.01, 0.1. Another useful presentation is the &lt;em&gt;ratio of recombination to mutation&lt;/em&gt;, using the highest genomic mutation rate (10&lt;sup&gt;-4&lt;/sup&gt;): 0, 0.1, 1, 10, 100, 1000, or compared to the 100-fold mutator: 0, 0.001, 0.01, 0.1, 1, 10.&lt;/p&gt;
&lt;p&gt;So we see that as soon as the &lt;em&gt;recombination to mutation ratio&lt;/em&gt; is 0.1 or lower (4&lt;sup&gt;th&lt;/sup&gt; column from the left in &lt;em&gt;Fig. 1A&lt;/em&gt;, if we consider the 100-fold increae), the fixation probability of mutators is ~50% or more. The conclusion here could be that mutators can evolve in a recombining population as long as recombination in not more than 10-fold stronger than mutation&lt;/p&gt;
&lt;p&gt;Of course this &lt;em&gt;10-fold&lt;/em&gt; estimate is highly dependent on the other paramters: the population size, the selection coefficients, the beneficial mutation rate, not to mention parameters that are not dealt with here such as epistasis.&lt;/p&gt;
&lt;h3 id="recombination-barriers"&gt;&lt;a href="#recombination-barriers"&gt;Recombination barriers&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A recombination barrier, in the context of these simulations, prevents recombination between mutator and non-mutator individuals, limiting recombination events to within the sub-populations.&lt;/p&gt;
&lt;p&gt;This is useful here because it allows to test if the source of the effect of recombination on the fixation of mutators is: &lt;strong&gt;1) breaking the linkage&lt;/strong&gt; of the mutator with the beneficial mutations it generates, or &lt;strong&gt;2) competing adaptive strategy&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;The 1&lt;sup&gt;st&lt;/sup&gt; effect is usually called the &lt;strong&gt;hitch-hiking effect&lt;/strong&gt;, or &lt;strong&gt;selective sweeps&lt;/strong&gt; &lt;span class="citation"&gt;(Charlesworth 2007)&lt;/span&gt;: mutators can &amp;quot;hitch-hike&amp;quot; with the beneficial mutations they generate to high frequencies as long as the LD (linkage disequilibrium) between them is intact. recombination tends to break this LD, robbing the mutators from their precious beneficial mutations. Even worse, recombination doesn't only take away the beneifical mutations, it even gives them to the mutators' &amp;quot;rivals&amp;quot; - the competing non-mutator alleles.&lt;/p&gt;
&lt;p&gt;The 2&lt;sup&gt;nd&lt;/sup&gt; effect is general - &lt;em&gt;competing adadptive strategy&lt;/em&gt;. How is recombination an &lt;em&gt;adaptive strategy&lt;/em&gt;?&lt;/p&gt;
&lt;p&gt;Asexual populations are limited by &lt;strong&gt;clonal interference&lt;/strong&gt; &lt;span class="citation"&gt;(Gerrish and Lenski 1998; Martens and Hallatschek 2011)&lt;/span&gt;. The following figure illustrates the idea:&lt;/p&gt;
&lt;p&gt;&lt;a href="http://en.wikipedia.org/wiki/Clonal_interference"&gt;&lt;img src="http://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Evolsex-dia2a.svg/500px-Evolsex-dia2a.svg.png" alt="Clonal Interference" /&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Clonal interference diagram from &lt;a href="http://en.wikipedia.org/wiki/File:Evolsex-dia2a.svg"&gt;Wikipedia&lt;/a&gt;. This diagram illustrates how sex might create novel genotypes more rapidly. Two beneficial mutations A and B occur at random. The two mutations are recombined rapidly in a sexual population (top), but in an asexual population (bottom) the two mutations must independently arise because of clonal interference. The effect of recombination and sex on the adaptation rate via the reduction of &lt;em&gt;clonal interference&lt;/em&gt; is also called the &lt;em&gt;Fisher-Muller effect&lt;/em&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If the reduction in fixation probability is due to the 1&lt;sup&gt;st&lt;/sup&gt; effect - separation of the mutators from the beneficial mutations they generate - then &lt;em&gt;recombination barriers&lt;/em&gt; are expected to revert the outcome, at least partially, to that of asexual populations.&lt;/p&gt;
&lt;p&gt;However, the results showed that &lt;em&gt;recombination barriers&lt;/em&gt; didn't recover the fixation probability of mutators to their levels without recombination. No figure presents the data, but the text provides some information: 7% fixation instead of 60% with beneficial mutation rate 10&lt;sup&gt;-8&lt;/sup&gt; and 0.3% instead of 16% with a rate of 10&lt;sup&gt;-9&lt;/sup&gt;. The conclusion is therefore that the 1&lt;sup&gt;st&lt;/sup&gt; effect is not enough to explain the reduction in the mutators adaptive advantage in the presence of recombination.&lt;/p&gt;
&lt;h3 id="invasion-to-a-moderate-mutator-background"&gt;&lt;a href="#invasion-to-a-moderate-mutator-background"&gt;Invasion to a moderate mutator background&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To check that the 2&lt;sup&gt;nd&lt;/sup&gt; effect is the determining effect, a 100-fold mutator invaded another mutator (instead of a non-mutator). The results are in &lt;a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC27047/figure/F2/"&gt;Figure 2&lt;/a&gt; - in general the fixation probability of a 100-fold mutator drops rapidly when competing with a 10-fold mutator and even a 5-fold mutator.&lt;/p&gt;
&lt;p&gt;This illustrates that competing adaptive strategies can reduce the fixation of mutators, and therefore that is is plausible that this is why recombination reduces the fixation of mutators.&lt;/p&gt;
&lt;h3 id="recombination-accelarates-adaptation"&gt;&lt;a href="#recombination-accelarates-adaptation"&gt;Recombination accelarates adaptation&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Setting the recombination rate at 10&lt;sup&gt;-4&lt;/sup&gt; gene conversions per individual per generations, the effect of other parameters was investigated:&lt;/p&gt;
&lt;h4 id="population-size"&gt;&lt;a href="#population-size"&gt;Population size&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;In asexuals, increasing the population size increases the fixation rate of mutators &lt;span class="citation"&gt;(Tenaillon et al. 1999)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;In recombining populations, this is not the case. &lt;a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC27047/figure/F3/"&gt;Figure 3A&lt;/a&gt; shows that for a population size &amp;lt;10&lt;sup&gt;6&lt;/sup&gt;, recombination has a very small effect on the fixation of a 100-fold mutator. However, the trends of the fixation probability are completely different for population size &amp;gt;10&lt;sup&gt;-6&lt;/sup&gt;. In asexual populations it increases (rapidly after 10&lt;sup&gt;7&lt;/sup&gt;), but in recombining populations it decreases and then increases a bit again at 10&lt;sup&gt;9&lt;/sup&gt;, but not much, never surprassing 0.2.&lt;/p&gt;
&lt;h4 id="beneficial-mutation-rate"&gt;&lt;a href="#beneficial-mutation-rate"&gt;Beneficial mutation rate&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The lower the beneficial mutation rate, the lower the fixation probability of mutators. &lt;a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC27047/figure/F4/"&gt;Figure 4&lt;/a&gt; shows that the fixation probability of mutators starts to increase at a beneficial mutation rate of 10&lt;sup&gt;-9&lt;/sup&gt; for asexual populations, but only at 10&lt;sup&gt;-8&lt;/sup&gt; for sexual populations.&lt;/p&gt;
&lt;h4 id="selection-coefficient-of-beneficial-mutations"&gt;&lt;a href="#selection-coefficient-of-beneficial-mutations"&gt;Selection coefficient of beneficial mutations&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;&lt;a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC27047/figure/F5/"&gt;Figure 5&lt;/a&gt; shows that the negative effect of recombination of the fixation of mutators decreases when the selection coefficient of beneficial mutations increases.&lt;/p&gt;
&lt;p&gt;For a selection coefficient of 0.01 &lt;span class="citation"&gt;(Kibota and Lynch 1996)&lt;/span&gt; recombination reduced the fixation probability of mutators 17-fold.&lt;/p&gt;
&lt;p&gt;A selection coefficient of 0.1, used in my own work [@Ram2012a], falls between the two right most points of &lt;a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC27047/figure/F5/"&gt;Figure 5&lt;/a&gt; - 2.5 and 3 - and the fixation probability of a 100-fold mutator allele drops ~10-fold due to recombination at a rate of 10&lt;sup&gt;-4&lt;/sup&gt; per gene per generation in a population with size 10&lt;sup&gt;9&lt;/sup&gt;.&lt;/p&gt;
&lt;h2 id="discussion"&gt;&lt;a href="#discussion"&gt;Discussion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This paper is &lt;em&gt;packed&lt;/em&gt; with interesting results. The effect of recombination on mutator evolution has not recieved alot of treatment using simulation (but see &lt;span class="citation"&gt;Levin and Cornejo (2009)&lt;/span&gt; and &lt;span class="citation"&gt;Sloan and Panjeti (2010)&lt;/span&gt; on which I hope to write some other time). So this is really interesting to someone interesed in the evolution of the mutation rate, even 12 years later.&lt;/p&gt;
&lt;p&gt;This work shows that indeed recombination has an effect on mutator evolution, and that this effect is highly sensitive - it is (I'm concentrating on when the effect is weak because that's when mutators are still going to evolve):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Weak in small populations (&amp;lt;10&lt;sup&gt;7&lt;/sup&gt;-10&lt;sup&gt;8&lt;/sup&gt;)&lt;/li&gt;
&lt;li&gt;Weak for high beneficial mutation rates (&amp;gt;10&lt;sup&gt;-8&lt;/sup&gt;-10&lt;sup&gt;-7&lt;/sup&gt;)&lt;/li&gt;
&lt;li&gt;Weaker for strong/intermediate selection&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It seems that in general the effect of recombination on mutator evolution (that is, on the evolution of high mutation rates) is weak when the adaptation rate of the population is low. In turn, the adaptation rate is a function of the &lt;strong&gt;supply of beneficial mutations&lt;/strong&gt; which is a function of population size and beneficial mutation rate, and of &lt;strong&gt;fixation time of beneficial mutations&lt;/strong&gt; which is a function of population size and selection strength.&lt;/p&gt;
&lt;p&gt;Selection of mutators is &lt;strong&gt;second-order selection&lt;/strong&gt;, in the sense that it indirectly affecting mutators. Because their results imply that second-order selection of mutators is very sensitive to the system parameters, &lt;em&gt;Tenaillon et al.&lt;/em&gt; propose that it may be unable to optimize the rates of mutation - in the sense that mutators will not be selected even when increasing the mutation rate will be beneficial to the population, in terms of fitness and adaptation rate. This can be resolved by &lt;strong&gt;transient hypermutation&lt;/strong&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Sex would therefore help bacteria approach an optimized mutation rate strategy composed of shifts towards high mutation rates in phases of adaptation under strong selective pressure and rapid recovery of low mutation rate once adaptation is achieved.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This view was also proposed by Ninio &lt;span class="citation"&gt;(1991)&lt;/span&gt; and expanded in a review from the same lab with the attractive title &lt;em&gt;The Rise and Fall of Mutator Bacteria&lt;/em&gt; &lt;span class="citation"&gt;(Giraud et al. 2001)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;I'm not sure if and how these results would change if a weaker mutator (10-fold mutation rate increase?) was used instead of the strong mutator (100-fold). For example, a paper from the same lab &lt;span class="citation"&gt;(Taddei et al. 1997)&lt;/span&gt; showed that a 10-fold mutator is more successful in invading finite populations (see &lt;a href="http://www.nature.com/nature/journal/v387/n6634/fig_tab/387700a0_F3.html"&gt;Figure 3A&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;I learned alot from this paper (and it predecessors &lt;span class="citation"&gt;(Taddei et al. 1997; Tenaillon et al. 1999)&lt;/span&gt;) about how to think of evolutionary simulations. And of course the science itself - the diverse network of interactions and effects between selection, drift, mutation and recombination.&lt;/p&gt;
&lt;h2 id="references"&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Charlesworth, Brian. 2007. &amp;#8220;A Hitch-hiking Guide To the Genome: a Commentary on &amp;#8217;The Hitch-hiking Effect of a Favourable Gene&amp;#8217; by John Maynard Smith and John Haigh.&amp;#8221; &lt;em&gt;Genetical Research&lt;/em&gt; 89 (5-6) (dec): 389&amp;#8211;90. doi:10.1017/S0016672308009580. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/18976526" title="http://www.ncbi.nlm.nih.gov/pubmed/18976526"&gt;http://www.ncbi.nlm.nih.gov/pubmed/18976526&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Drake, John W. 1991. &amp;#8220;A Constant Rate of Spontaneous Mutation in DNA-based Microbes.&amp;#8221; &lt;em&gt;Proceedings of the National Academy of Sciences of the United States of America&lt;/em&gt; 88 (16) (aug): 7160&amp;#8211;4. doi:10.1073/pnas.88.16.7160. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=52253" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=52253"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=52253&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Falush, Daniel, Christian Kraft, Nancy S. Taylor, Pelayo Correa, James G. Fox, Mark Achtman, and Sebastian Suerbaum. 2001. &amp;#8220;Recombination and Mutation During Long-term Gastric Colonization by Helicobacter Pylori: Estimates of Clock Rates, Recombination Size, and Minimal Age.&amp;#8221; &lt;em&gt;Proceedings of the National Academy of Sciences of the United States of America&lt;/em&gt; 98 (26) (dec): 15056&amp;#8211;61. doi:10.1073/pnas.251396098. &lt;a href="http://www.pnas.org/cgi/content/abstract/98/26/15056 http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=64982" title="http://www.pnas.org/cgi/content/abstract/98/26/15056 http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=64982"&gt;http://www.pnas.org/cgi/content/abstract/98/26/15056 http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=64982&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Gerrish, Philip J., and Richard E. Lenski. 1998. &amp;#8220;The Fate of Competing Beneficial Mutations in an Asexual Population.&amp;#8221; &lt;em&gt;Genetica&lt;/em&gt; 102-103 (0): 127&amp;#8211;144&amp;#8211;144. doi:10.1023/A:1017067816551. &lt;a href="http://www.springerlink.com/content/np187h5878166310/" title="http://www.springerlink.com/content/np187h5878166310/"&gt;http://www.springerlink.com/content/np187h5878166310/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Giraud, Antoine, Ivan Matic, Olivier Tenaillon, Antonio Clara, Miroslav Radman, Michel Fons, and Fran&amp;#231;ois Taddei. 2001. &amp;#8220;Costs and Benefits of High Mutation Rates: Adaptive Evolution of Bacteria in the Mouse Gut.&amp;#8221; &lt;em&gt;Science&lt;/em&gt; 291 (5513) (mar): 2606&amp;#8211;8. doi:10.1126/science.1056421. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/11283373" title="http://www.ncbi.nlm.nih.gov/pubmed/11283373"&gt;http://www.ncbi.nlm.nih.gov/pubmed/11283373&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Hill, W. G., and Alan Robertson. 1966. &amp;#8220;The Effect of Linkage on Limits To Artificial Selection.&amp;#8221; &lt;em&gt;Genetical Research&lt;/em&gt; 8 (3) (dec): 269&amp;#8211;94. doi:10.1017/S0016672300010156. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/5980116 http://www.journals.cambridge.org/abstract\_S0016672300010156" title="http://www.ncbi.nlm.nih.gov/pubmed/5980116 http://www.journals.cambridge.org/abstract\_S0016672300010156"&gt;http://www.ncbi.nlm.nih.gov/pubmed/5980116 http://www.journals.cambridge.org/abstract\_S0016672300010156&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Johnson, Toby. 1999. &amp;#8220;Beneficial Mutations, Hitchhiking and the Evolution of Mutation Rates in Sexual Populations.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 151 (4) (apr): 1621&amp;#8211;31. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1460574\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1460574\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1460574\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Kibota, Travis T., and Michael Lynch. 1996. &amp;#8220;Estimate of the Genomic Mutation Rate Deleterious To Overall Fitness in E. Coli.&amp;#8221; &lt;em&gt;Nature&lt;/em&gt; 381 (6584) (jun): 694&amp;#8211;6. doi:10.1038/381694a0. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/8649513" title="http://www.ncbi.nlm.nih.gov/pubmed/8649513"&gt;http://www.ncbi.nlm.nih.gov/pubmed/8649513&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Leigh, Egbert Giles. 1973. &amp;#8220;The Evolution of Mutation Rates.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 73 (apr): Suppl73:1&amp;#8211;18. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/4711556" title="http://www.ncbi.nlm.nih.gov/pubmed/4711556"&gt;http://www.ncbi.nlm.nih.gov/pubmed/4711556&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Levin, Bruce R., and Omar E. Cornejo. 2009. &amp;#8220;The Population and Evolutionary Dynamics of Homologous Gene Recombination in Bacterial Populations.&amp;#8221; &lt;em&gt;PLoS Genetics&lt;/em&gt; 5 (8) (aug): e1000601. doi:10.1371/journal.pgen.1000601. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2717328\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2717328\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2717328\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Martens, Erik A., and Oskar Hallatschek. 2011. &amp;#8220;Interfering Waves of Adaptation Promote Spatial Mixing.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 189 (3) (sep): 1045&amp;#8211;1060. doi:10.1534/genetics.111.130112. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/21900264" title="http://www.ncbi.nlm.nih.gov/pubmed/21900264"&gt;http://www.ncbi.nlm.nih.gov/pubmed/21900264&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Milkman, Roger, and Mellissa McKane Bridges. 1990. &amp;#8220;Molecular Evolution of the Escherichia Coli Chromosome. III. Clonal Frames.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 126 (3) (nov): 505&amp;#8211;17. &lt;a href="http://mutage.oxfordjournals.org/cgi/doi/10.1093/mutage/2.2.147 http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1204208" title="http://mutage.oxfordjournals.org/cgi/doi/10.1093/mutage/2.2.147 http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1204208"&gt;http://mutage.oxfordjournals.org/cgi/doi/10.1093/mutage/2.2.147 http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1204208&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Ninio, Jacques. 1991. &amp;#8220;Transient Mutators: a Semiquantitative Analysis of the Influence of Translation and Transcription Errors on Mutation Rates.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 129 (3) (nov): 957&amp;#8211;62. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1204761\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1204761\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1204761\&amp;amp;tool=pmcentrez\&amp;amp;rendertype=abstract&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Ram, Yoav, and Lilach Hadany. 2012. &amp;#8220;The Evolution of Stress-induced Hypermutation in Asexual Populations.&amp;#8221; &lt;em&gt;Evolution&lt;/em&gt; 66 (7) (jul): 2315&amp;#8211;28. doi:10.1111/j.1558-5646.2012.01576.x. &lt;a href="http://doi.wiley.com/10.1111/j.1558-5646.2012.01576.x http://www.ncbi.nlm.nih.gov/pubmed/22759304" title="http://doi.wiley.com/10.1111/j.1558-5646.2012.01576.x http://www.ncbi.nlm.nih.gov/pubmed/22759304"&gt;http://doi.wiley.com/10.1111/j.1558-5646.2012.01576.x http://www.ncbi.nlm.nih.gov/pubmed/22759304&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sloan, Daniel B., and Vijay G. Panjeti. 2010. &amp;#8220;Evolutionary Feedbacks Between Reproductive Mode and Mutation Rate Exacerbate the Paradox of Sex.&amp;#8221; &lt;em&gt;Evolution&lt;/em&gt; 64 (4) (apr): 1129&amp;#8211;35. doi:10.1111/j.1558-5646.2009.00869.x. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/19863589" title="http://www.ncbi.nlm.nih.gov/pubmed/19863589"&gt;http://www.ncbi.nlm.nih.gov/pubmed/19863589&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Taddei, Fran&amp;#231;ois, Miroslav Radman, John Maynard Smith, Bruno Toupance, Pierre-Henri Gouyon, and Bernard Godelle. 1997. &amp;#8220;Role of Mutator Alleles in Adaptive Evolution.&amp;#8221; &lt;em&gt;Nature&lt;/em&gt; 387 (6634) (jun): 700&amp;#8211;2. doi:10.1038/42696. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/9192893" title="http://www.ncbi.nlm.nih.gov/pubmed/9192893"&gt;http://www.ncbi.nlm.nih.gov/pubmed/9192893&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Tenaillon, Olivier, Herve Le Nagard, Bernard Godelle, and Fran&amp;#231;ois Taddei. 2000. &amp;#8220;Mutators and Sex in Bacteria: Conflict Between Adaptive Strategies.&amp;#8221; &lt;em&gt;Proceedings of the National Academy of Sciences of the United States of America&lt;/em&gt; 97 (19) (sep): 10465&amp;#8211;70. doi:10.1073/pnas.180063397. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/10973474" title="http://www.ncbi.nlm.nih.gov/pubmed/10973474"&gt;http://www.ncbi.nlm.nih.gov/pubmed/10973474&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Tenaillon, Olivier, Bruno Toupance, Herve Le Nagard, Fran&amp;#231;ois Taddei, and Bernard Godelle. 1999. &amp;#8220;Mutators, Population Size, Adaptive Landscape and the Adaptation of Asexual Populations of Bacteria.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 152 (2): 485&amp;#8211;493. &lt;a href="http://www.genetics.org/cgi/content/abstract/152/2/485" title="http://www.genetics.org/cgi/content/abstract/152/2/485"&gt;http://www.genetics.org/cgi/content/abstract/152/2/485&lt;/a&gt;.&lt;/p&gt;
&lt;div class="footnotes"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn1"&gt;&lt;p&gt;Alleles that increase the global mutation rate. For example, a mutant allele of the &lt;em&gt;mutS&lt;/em&gt; gene can reduce the efficiency of DNA repair, allowing more mutations to slip though the repair mechanisms.&lt;a href="#fnref1"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn2"&gt;&lt;p&gt;A density-based model is one where the &lt;em&gt;number&lt;/em&gt; of individuals in each class is monitored and modified from one generation to the next. This is in contrast to frequency-dependent models in which the frequency of individuals in each class is monitored.&lt;a href="#fnref2"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Mean fitness at the mutation-selection balance</title>
    <id>http://blog.yoavram.com/mean-fitness-at-the-mutation-selection-balance/</id>
    <updated>2012-10-14T14:45:00Z</updated>
    <link href="http://blog.yoavram.com/mean-fitness-at-the-mutation-selection-balance/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#simple-approximation"&gt;Simple approximation&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#single-locus"&gt;Single locus&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#multiple-locus"&gt;Multiple locus&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#matrix-theory-the-perron-frobenius-theorem"&gt;Matrix Theory: the Perron-Frobenius theorem&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#summary"&gt;Summary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a name='TOC'&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="overview"&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The first post on the &lt;a href="http://blog.yoavram.com"&gt;Mutation-Selection Blog&lt;/a&gt; must be about the &lt;em&gt;mutation-selection balance&lt;/em&gt;, right?&lt;/p&gt;
&lt;p&gt;So what is the mutation-selection balance?&lt;/p&gt;
&lt;p&gt;In evolutionary biology, selection acts to remove deleterious mutations from the population, while mutation generates new deleterious mutations. When they cancel each other out, the population is at the &lt;strong&gt;mutation-selection balance&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;We'll start by defining &lt;strong&gt;fitness&lt;/strong&gt;. In the following treatment, the fitness of an individual is his reproductive success compared to the reproductive sucess of the most succesful individual in the population.&lt;/p&gt;
&lt;p&gt;More formally, denote the fitness of individual &lt;em&gt;i&lt;/em&gt; at generation &lt;em&gt;n&lt;/em&gt; by &lt;span class="math"&gt;\(\omega_{i,n}\)&lt;/span&gt;, and define the (population) mean fitness at generation &lt;em&gt;n&lt;/em&gt; by &lt;span class="math"&gt;\(\bar{\omega}_n = E_i[\omega_{i,n}]\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;At the mutation-selection balance the mean fitness is at an equilibrium, that is, it doesn't change from one generation to the next: &lt;span class="math"&gt;\[
\bar{\omega}_{n+1} = \bar{\omega}_n
\]&lt;/span&gt; The value of this equilibrium is denoted by &lt;span class="math"&gt;\(\bar{\omega}^*\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;A classical result by &lt;span class="citation"&gt;(Kimura and Maruyama 1966)&lt;/span&gt; involves a system in which an infinite population is evolving under &lt;em&gt;selection&lt;/em&gt; and &lt;em&gt;mutation&lt;/em&gt;. Mutation is unidirectional and deleterious and occurs with a rate &lt;em&gt;U&lt;/em&gt;, selection is constant and uniform, the enivronment is constant, and there is no drift, sex, recombination or migration. This is a simplistic model but one that is able to capture the dynamics of some complex systems. The elegant result is that the mean fitness of a population is not dependent on selection strength and is an exponentialy decreasing function of the mutation rate &lt;em&gt;U&lt;/em&gt;: &lt;span class="math"&gt;\[
\bar{\omega}^* = e^{-U}
\]&lt;/span&gt;&lt;/p&gt;
&lt;h2 id="simple-approximation"&gt;&lt;a href="#simple-approximation"&gt;Simple approximation&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="single-locus"&gt;&lt;a href="#single-locus"&gt;Single locus&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;In this section I roughly follow the route of &lt;span class="citation"&gt;(Gillespie 2004)&lt;/span&gt;. To reach this formula in a simple way (all you need is some straightforward &lt;em&gt;Calculus&lt;/em&gt; and a little bit of &lt;em&gt;Genetics&lt;/em&gt;), we start by looking at a single locus&lt;sup&gt;&lt;a href="#fn1" class="footnoteRef" id="fnref1"&gt;1&lt;/a&gt;&lt;/sup&gt; with two alleles&lt;sup&gt;&lt;a href="#fn2" class="footnoteRef" id="fnref2"&gt;2&lt;/a&gt;&lt;/sup&gt;, denoted by &lt;em&gt;A&lt;/em&gt; and &lt;em&gt;a&lt;/em&gt;, which have fitness of &lt;em&gt;1&lt;/em&gt; and &lt;em&gt;1-s&lt;/em&gt;, respectively, with &lt;em&gt;s&lt;/em&gt; playing the part of the &lt;em&gt;selection coefficient&lt;/em&gt; which defines the deleterious multiplicative effect a deleterious mutation has on the fitness of an individual.&lt;/p&gt;
&lt;p&gt;Define &lt;em&gt;p&lt;/em&gt; and &lt;em&gt;q&lt;/em&gt; to be the frequencies of &lt;em&gt;A&lt;/em&gt; and &lt;em&gt;a&lt;/em&gt; so that &lt;em&gt;p+q=1&lt;/em&gt;. Denote the probability that the wild-type allele &lt;em&gt;A&lt;/em&gt; mutates to allele &lt;em&gt;a&lt;/em&gt; by &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; (without back-mutations, that is, &lt;em&gt;a&lt;/em&gt; doesn't mutate back to &lt;em&gt;A&lt;/em&gt;), and denote the frequency of &lt;em&gt;A&lt;/em&gt; after one generation by &lt;em&gt;p'&lt;/em&gt;&lt;sup&gt;&lt;a href="#fn3" class="footnoteRef" id="fnref3"&gt;3&lt;/a&gt;&lt;/sup&gt;: &lt;span class="math"&gt;\[
p&amp;#39; = \frac{p(1-\mu)}{\bar{\omega}}
\]&lt;/span&gt; with the population mean fitness &lt;span class="math"&gt;\(\bar{\omega} = p + q(1-s)\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;To find the equilibirum value of &lt;em&gt;p&lt;/em&gt;, one must subtitute &lt;span class="math"&gt;\(p&amp;#39;=p\)&lt;/span&gt; and &lt;span class="math"&gt;\(q=1-p\)&lt;/span&gt;: &lt;span class="math"&gt;\[
p = \frac{p(1-\mu)}{p + (1-p)(1-s)} \Rightarrow \\
p(p+(1-p)(1-s)) = p(1-\mu) \Rightarrow
\]&lt;/span&gt; we assume &lt;span class="math"&gt;\(p\ne 0\)&lt;/span&gt; because we are not interested in a population of mutants: &lt;span class="math"&gt;\[
p+(1-p)(1-s) = 1-\mu \Rightarrow \\
p+1-s-p+ps = 1-\mu \Rightarrow \\
-s+ps = -\mu \Rightarrow \\ 
ps = s-\mu \Rightarrow \\
p = 1-\frac{\mu}{s} 
\]&lt;/span&gt; So &lt;span class="math"&gt;\(p^*=1-\frac{\mu}{s}\)&lt;/span&gt;, that is &lt;span class="math"&gt;\(q^*=\frac{\mu}{s}\)&lt;/span&gt;, which makes sense - the mutant allele is produced by a rate &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; and eliminated at a rate &lt;span class="math"&gt;\(s\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The mean fitness is therefore: &lt;span class="math"&gt;\[
\bar{\omega}^* = p^* + (1-p^*)(1-s) = 1-\frac{\mu}{s} + \frac{\mu}{s} (1-s) =
1-\frac{\mu}{s} + \frac{\mu}{s} - s \frac{\mu}{s} \Rightarrow \\
\bar{\omega}^* = 1 - \mu 
\]&lt;/span&gt; This, however, is the mean fitness due to a single locus, not the entire genome.&lt;/p&gt;
&lt;h3 id="multiple-locus"&gt;&lt;a href="#multiple-locus"&gt;Multiple locus&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Moving on to a multiple locus model with an arbitrary number of loci&lt;sup&gt;&lt;a href="#fn4" class="footnoteRef" id="fnref4"&gt;4&lt;/a&gt;&lt;/sup&gt;, we define the mutation rate at locus &lt;em&gt;j&lt;/em&gt; as &lt;span class="math"&gt;\(\mu_j\)&lt;/span&gt;, so the mean fitness at the mutation-selection balance in locus &lt;em&gt;j&lt;/em&gt; is &lt;span class="math"&gt;\(\bar{\omega}^*_j = 1 - \mu_j\)&lt;/span&gt;, and because fitness is multiplicative: &lt;span class="math"&gt;\[
\bar{\omega}^* = \prod_{j}{\bar{\omega}_j^*} = \prod_{j}{1-\mu_j} \Rightarrow \\
ln{(\bar{\omega}^*)} = \sum_{j}{1-\mu_j} 
\]&lt;/span&gt; This can be approximated, because when &lt;span class="math"&gt;\(x\)&lt;/span&gt; is small &lt;span class="math"&gt;\(ln{(1-x)}\approx -x\)&lt;/span&gt;, and &lt;span class="math"&gt;\(\mu\)&lt;/span&gt; is probably at most &lt;span class="math"&gt;\(\approx 10^{-2}\)&lt;/span&gt; or even lower: &lt;span class="math"&gt;\[
ln{(\bar{\omega}^*)}  \approx \sum_{j}{-\mu_j} = -U
\]&lt;/span&gt; as &lt;em&gt;U&lt;/em&gt; is the mutation rate per genome per generation.&lt;/p&gt;
&lt;p&gt;So This is how we can derive an approximation of the mean fitness at the mutation-selection balance: &lt;span class="math"&gt;\[
\bar{\omega}^* = e^{-U}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;You can find this derivation at the begining of a &lt;a href="http://dx.doi.org/10.6084/m9.figshare.95940"&gt;presentation&lt;/a&gt; I gave at the &lt;a href="http://biomathsjctau.wordpress.com"&gt;BioMath Student Journal Club at Tel-Aviv University&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="matrix-theory-the-perron-frobenius-theorem"&gt;&lt;a href="#matrix-theory-the-perron-frobenius-theorem"&gt;Matrix Theory: the Perron-Frobenius theorem&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We can produce the same result without approximations using a bit heavier mathematics, but not much heavier - this is still undergraduate &lt;em&gt;Linear Algebra&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;This time we start with the multiple locus model right away. Instead of following allele frequencies, though, we follow the frequency of individuals with &lt;em&gt;i&lt;/em&gt; mutant alleles, or &lt;em&gt;i&lt;/em&gt; deleterious mutations, which we denote by &lt;em&gt;p&lt;sub&gt;i&lt;/sub&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;We assume that the number of mutations per generation is &lt;em&gt;Poisson&lt;/em&gt; distributed with the mutation rate as the parameter of the distribution, so that the probability that &lt;em&gt;k&lt;/em&gt; mutations will occur in an individual with a mutaiton rate of &lt;em&gt;U&lt;/em&gt; is &lt;span class="math"&gt;\[
\varphi_U(k) = \frac{U^k e^U}{k!}
\]&lt;/span&gt; The equation system describing the change in the freuqnecy of individuals with &lt;em&gt;i&lt;/em&gt; mutant alleles is: &lt;span class="math"&gt;\[
p&amp;#39;_{i} = \sum_{ k=0 }^{i}{ p_{k} \frac{ \omega_{k} } {\bar{\omega}} \varphi_{U} (i-k)}, \; \; \forall i \ge 0
\]&lt;/span&gt; where &lt;span class="math"&gt;\(\omega_i\)&lt;/span&gt; is the fitness of individuals with &lt;em&gt;i&lt;/em&gt; mutant alleles.&lt;/p&gt;
&lt;p&gt;The above equation system can be written in matrix form: &lt;span class="math"&gt;\[
\bar{\omega}p&amp;#39; = Mp
\]&lt;/span&gt; where &lt;span class="math"&gt;\(p=(p_0,p_1,p_2,...)\)&lt;/span&gt; and &lt;em&gt;M&lt;/em&gt; is: &lt;span class="math"&gt;\[
M = \left(\begin{array}{cccc}
\omega_0 \varphi_U(0)   &amp;amp; 0                         &amp;amp; 0                         &amp;amp;  ...\\
\omega_0 \varphi_U(1)   &amp;amp; \omega_1 \varphi_U(0)     &amp;amp; 0                         &amp;amp;  ...\\
\omega_0 \varphi_U(2)   &amp;amp; \omega_1 \varphi_U(1)     &amp;amp; \omega_2 \varphi_U(0)     &amp;amp;  ...\\ 
...                     &amp;amp; ...                       &amp;amp; ...                       &amp;amp;  ...
\end{array}\right)
\]&lt;/span&gt; This matrix is called a &lt;a href="http://en.wikipedia.org/wiki/Stochastic_matrix"&gt;transition matrix&lt;/a&gt; because its entries &lt;span class="math"&gt;\(M_{i,j}\)&lt;/span&gt; are the transition probabilities from state &lt;em&gt;j&lt;/em&gt; to state &lt;em&gt;i&lt;/em&gt; - the state is the number of mutant alleles.&lt;/p&gt;
&lt;p&gt;Now if we set &lt;span class="math"&gt;\(p^*=p&amp;#39;=p\)&lt;/span&gt; we get &lt;span class="math"&gt;\(\bar{\omega}^*p^*=Mp^*\)&lt;/span&gt;, so if there is &lt;span class="math"&gt;\(\bar{\omega}^*\)&lt;/span&gt; and &lt;span class="math"&gt;\(p^*\)&lt;/span&gt; such that &lt;span class="math"&gt;\(p^*_i \ge 0 \; \sum_{i}{p^*_i}=1\)&lt;/span&gt; that solve this equation, then &lt;span class="math"&gt;\(p^*\)&lt;/span&gt; is an &lt;strong&gt;eigenvector&lt;/strong&gt; of &lt;em&gt;M&lt;/em&gt; and &lt;span class="math"&gt;\(\bar{\omega}^*\)&lt;/span&gt; is an &lt;strong&gt;eigenvalue&lt;/strong&gt; of M.&lt;/p&gt;
&lt;p&gt;From the &lt;a href="http://en.wikipedia.org/wiki/Perron%E2%80%93Frobenius_theorem"&gt;Perron-Frobenius theorem&lt;/a&gt; we know that this matrix always has a unique non-negative eigenvector, so &lt;span class="math"&gt;\(p^*\)&lt;/span&gt; exists and it is unique. Furthermore, from the same theorem we know that &lt;span class="math"&gt;\(\bar{\omega}^*\)&lt;/span&gt; also exists and that it is the leading (largest positive) eigenvalue of &lt;em&gt;M&lt;/em&gt; &lt;span class="citation"&gt;(Otto and Day 2007, 709)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Since this is a triangular matrix, the eigenvalues are simply the elements on the diagonal&lt;sup&gt;&lt;a href="#fn5" class="footnoteRef" id="fnref5"&gt;5&lt;/a&gt;&lt;/sup&gt;. Therefore, the largest eigenvalue must be the largest element on the diagonal, which is the element &lt;span class="math"&gt;\[
\bar{\omega}^* = M_{0,0} = 
\omega_0 \varphi_U(0) = (1-s)^0 \frac{U^0 e^{-U}}{0!} = 
e^{-U}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Note that if beneficial mutations or back-mutations were allowed in this model, we would not be able to derive the eigenvalue so easily, because the matrix would not be triagonal. However, it would still agree with the conditions of the Perron-Frobenius theorem and the mean fitness at the mutation-selection balance would still be the leading eigenvalue of the matrix, and would exist. I've used this fact in my paper &lt;em&gt;The Evolution of Stress-Induced Hypermutation in Asexual Populations&lt;/em&gt; &lt;span class="citation"&gt;(Ram and Hadany 2012)&lt;/span&gt;.&lt;/p&gt;
&lt;h2 id="summary"&gt;&lt;a href="#summary"&gt;Summary&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We've seen how to derive the mean fitness at the mutation-selection balance &lt;span class="math"&gt;\(\bar{\omega} = e^{-U}\)&lt;/span&gt; both via a first-order approximation and via a more &amp;quot;hardcore&amp;quot; linear algerba method.&lt;/p&gt;
&lt;p&gt;The nice thing about deriving the mean fitness in the &amp;quot;hardcore&amp;quot; method is that we get some idea of &lt;em&gt;why&lt;/em&gt; it is equal to e&lt;sup&gt;-U&lt;/sup&gt;. We found that the mean fitness at the mutation-selection balance equals to the leading eigenvalue of the transition matrix, which is the relative probability that individuals from the least loaded class (the class of fittest individuals) survive to the next generation without mutating. By definition the fitness of the least loaded individuals is 1, and we assumed the mutations are &lt;em&gt;Poisson&lt;/em&gt; distributed, and therefore we got e&lt;sup&gt;-U&lt;/sup&gt;, but if we change these assumptions the general result will still hold:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The mean fitness of an asexual population at the mutation-selection balance, in the absence of beneficial mutations, is the product of the fitness of the least loaded class and the probability that no mutations occur.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;What's left?&lt;/p&gt;
&lt;p&gt;The next step - in the next post - will be to derive a formula for the mean fitness at each generation. This is important because we need to understand how &lt;em&gt;rapidly&lt;/em&gt; the mean fitness converges towards the equilibrium value. Can we really assume that the evolutionary process has reached the mutation-selection balance in calculations we perform?&lt;/p&gt;
&lt;p&gt;One article that presents an analysis on this subject is &lt;span class="citation"&gt;(Gordo and Dionisio 2005)&lt;/span&gt;, which shows how to derive the mean fitness of a population at genearation &lt;em&gt;n&lt;/em&gt;. This is still a simple asexual population with directional selection and unidirectional deleterious mutations, but it is still very interesting, and I'll try to post a comprehensive explanation on how it can be done.&lt;/p&gt;
&lt;h2 id="references"&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Gillespie, John H. 2004. &lt;em&gt;Population Genetics: a Concise Guide&lt;/em&gt;. 2nd ed.. Johns Hopkins University Press. &lt;a href="http://www.google.com/books?id=KAcAfiyHpcoC" title="http://www.google.com/books?id=KAcAfiyHpcoC"&gt;http://www.google.com/books?id=KAcAfiyHpcoC&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Gordo, Isabel, and Francisco Dionisio. 2005. &amp;#8220;Nonequilibrium Model for Estimating Parameters of Deleterious Mutations.&amp;#8221; &lt;em&gt;Physical Review E&lt;/em&gt; 71 (3) (mar): 18&amp;#8211;21. doi:10.1103/PhysRevE.71.031907. &lt;a href="http://link.aps.org/doi/10.1103/PhysRevE.71.031907" title="http://link.aps.org/doi/10.1103/PhysRevE.71.031907"&gt;http://link.aps.org/doi/10.1103/PhysRevE.71.031907&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Kimura, Motoo, and Takeo Maruyama. 1966. &amp;#8220;The Mutational Load With Epistatic Gene Interactions in Fitness.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 54 (6) (dec): 1337&amp;#8211;51. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1211299" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1211299"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=1211299&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Otto, Sarah P., and Troy Day. 2007. &lt;em&gt;A Biologist&amp;#8217;s Guide To Mathematical Modeling in Ecology and Evolution&lt;/em&gt;. Princeton University Press.&lt;/p&gt;
&lt;p&gt;Ram, Yoav, and Lilach Hadany. 2012. &amp;#8220;The Evolution of Stress-induced Hypermutation in Asexual Populations.&amp;#8221; &lt;em&gt;Evolution&lt;/em&gt; 66 (7) (jul): 2315&amp;#8211;28. doi:10.1111/j.1558-5646.2012.01576.x. &lt;a href="http://doi.wiley.com/10.1111/j.1558-5646.2012.01576.x http://www.ncbi.nlm.nih.gov/pubmed/22759304" title="http://doi.wiley.com/10.1111/j.1558-5646.2012.01576.x http://www.ncbi.nlm.nih.gov/pubmed/22759304"&gt;http://doi.wiley.com/10.1111/j.1558-5646.2012.01576.x http://www.ncbi.nlm.nih.gov/pubmed/22759304&lt;/a&gt;.&lt;/p&gt;
&lt;div class="footnotes"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn1"&gt;&lt;p&gt;A site on the genome which may be occupied by different alleles. The function of a locus can be diverse - genes, transcription control sequences, etc.&lt;a href="#fnref1"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn2"&gt;&lt;p&gt;A specific sequence occupying a locus, with a specific function. One locus can potentially contain different alleles, each with a slightly different sequence and potentially drasticly different effects on function.&lt;a href="#fnref2"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn3"&gt;&lt;p&gt;A note on notation - &lt;em&gt;p'&lt;/em&gt; here is &lt;em&gt;not&lt;/em&gt; the derivative of &lt;em&gt;p&lt;/em&gt; but rather the value of &lt;em&gt;p&lt;/em&gt; at the next generation. The notation is sometimes confusing but is customary in &lt;em&gt;population genetics&lt;/em&gt;. All equations presented here are &lt;em&gt;difference equations&lt;/em&gt;, not &lt;em&gt;differential equations&lt;/em&gt;.&lt;a href="#fnref3"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn4"&gt;&lt;p&gt;The plural of &lt;em&gt;locus&lt;/em&gt;.&lt;a href="#fnref4"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn5"&gt;&lt;p&gt;To prove this, one must notice that the determinant of a triangular matrix is the trace of the matrix, and therefore the characteristic polynomial is the trace of the matrix &lt;span class="math"&gt;\(I\lambda - M\)&lt;/span&gt;, and the eigenvalues are the solutions of this polynomial - see &lt;a href="http://tutorial.math.lamar.edu/Classes/LinAlg/EVals_Evects.aspx#EV_EvalEvec_Thm1"&gt;Paul's online math notes&lt;/a&gt;.&lt;a href="#fnref5"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Citations in Markdown using Pandoc</title>
    <id>http://blog.yoavram.com/citations-in-markdown-using-pandoc/</id>
    <updated>2012-10-12T13:35:00Z</updated>
    <link href="http://blog.yoavram.com/citations-in-markdown-using-pandoc/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#problem-1"&gt;Problem 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#solution-1"&gt;Solution 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#problem-2"&gt;Problem 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#solution-2"&gt;Solution 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#problem-3"&gt;Problem 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#solution-3"&gt;Solution 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#problem-4"&gt;Problem 4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#solution-4"&gt;Solution 4&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#problem-5"&gt;Problem 5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#examples"&gt;Examples&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a name='TOC'&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="overview"&gt;&lt;a href="#overview"&gt;Overview&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt; is an amazing tool that can convert one markup language to another. It is very goot at parsing &lt;em&gt;Markdown&lt;/em&gt; and it has the ability to parse &lt;a href="http://johnmacfarlane.net/pandoc/README.html#citations"&gt;citations in &lt;em&gt;Markdown&lt;/em&gt;&lt;/a&gt;, which is exactly what I was looking for!&lt;/p&gt;
&lt;p&gt;But I had some things to solve first.&lt;/p&gt;
&lt;h2 id="problem-1"&gt;&lt;a href="#problem-1"&gt;Problem 1&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Pandoc&lt;/em&gt; didn't work with the &lt;code&gt;--bibliography&lt;/code&gt; option (test using &lt;code&gt;pandoc -s -S --bibliography=references.bib test.md&lt;/code&gt;)&lt;/p&gt;
&lt;h2 id="solution-1"&gt;&lt;a href="#solution-1"&gt;Solution 1&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Change &lt;em&gt;Pandoc&lt;/em&gt; version from &lt;em&gt;1.9.4.2a&lt;/em&gt; to &lt;em&gt;1.9.4.2&lt;/em&gt; (see &lt;a href="http://johnmacfarlane.net/pandoc/installing.html"&gt;Install page&lt;/a&gt; - if you don't see the earlier version change from &lt;em&gt;Current downloads&lt;/em&gt; to &lt;em&gt;All downloads&lt;/em&gt; and hit &lt;em&gt;Search&lt;/em&gt;.&lt;/p&gt;
&lt;h2 id="problem-2"&gt;&lt;a href="#problem-2"&gt;Problem 2&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I want to run &lt;em&gt;Pandoc&lt;/em&gt; from my &lt;em&gt;Python&lt;/em&gt; site generator. So I tried &lt;a href="http://pypi.python.org/pypi/pyandoc/"&gt;pyandoc&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Whenever I run the test &lt;em&gt;pyandoc&lt;/em&gt;, though, I got an error that &amp;quot;Windows can't find the specified file&amp;quot;. I filed an &lt;a href="https://github.com/kennethreitz/pyandoc/issues/5"&gt;issue&lt;/a&gt; and then found a solution.&lt;/p&gt;
&lt;h2 id="solution-2"&gt;&lt;a href="#solution-2"&gt;Solution 2&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The path to the pandoc executable doesn't &lt;em&gt;really&lt;/em&gt; change when setting it from &lt;em&gt;Python&lt;/em&gt;, so you got to change it in the original &lt;em&gt;pyandoc&lt;/em&gt; file - &lt;code&gt;C:\Python27\Lib\site-packages\pandoc\core.py&lt;/code&gt;, and the code change is simply setting the &lt;code&gt;PANDOC_PATH&lt;/code&gt; variable to the full path to your &lt;code&gt;pandoc.exe&lt;/code&gt;.&lt;/p&gt;
&lt;h2 id="problem-3"&gt;&lt;a href="#problem-3"&gt;Problem 3&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;How to use pyandoc to parse my &lt;em&gt;Markdown&lt;/em&gt; files? Well, it looks pretty easy, writing a function that uses &lt;em&gt;pyandoc&lt;/em&gt; and setting it at &lt;code&gt;sitebuilder.py&lt;/code&gt;&lt;sup&gt;&lt;a href="#fn1" class="footnoteRef" id="fnref1"&gt;1&lt;/a&gt;&lt;/sup&gt; for the varialbe &lt;code&gt;FLATPAGES_HTML_RENDERER&lt;/code&gt; that controls the renderer of pages. But &lt;em&gt;pyandoc&lt;/em&gt; doesn't use &lt;code&gt;--bibliography&lt;/code&gt; and &lt;code&gt;--csl&lt;/code&gt;!&lt;/p&gt;
&lt;h2 id="solution-3"&gt;&lt;a href="#solution-3"&gt;Solution 3&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I forked &lt;em&gt;pyandoc&lt;/em&gt; and added support for the &lt;code&gt;--bibliography&lt;/code&gt; and &lt;code&gt;--csl&lt;/code&gt; options. The code is on &lt;a href="https://github.com/yoavram/pyandoc"&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Also, I've written a new module for the site generator called &lt;em&gt;renderers&lt;/em&gt; which has a factory function that creates a &lt;em&gt;Pandoc&lt;/em&gt; renderer. The &lt;em&gt;Pandoc&lt;/em&gt; renderer uses my modified &lt;em&gt;pyandoc&lt;/em&gt; to render &lt;em&gt;Markdown&lt;/em&gt; text to &lt;em&gt;HTML&lt;/em&gt;, including citations, math and everything.&lt;/p&gt;
&lt;p&gt;This &lt;em&gt;Pandoc&lt;/em&gt; renderer can be used as the &lt;code&gt;FLATPAGES_HTML_RENDERER&lt;/code&gt; for &lt;a href="http://packages.python.org/Flask-FlatPages/#flask_flatpages"&gt;Flask-FlatPages&lt;/a&gt; on my &lt;code&gt;sitebuilder.py&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The previous renderer was based on the default &lt;a href="http://freewisdom.org/projects/python-markdown/"&gt;Python-Markdown&lt;/a&gt; with some extensions, so I had to find replacements for these extensions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;MathJax&lt;/em&gt; - just add &lt;code&gt;--mathjax&lt;/code&gt; to the &lt;em&gt;Pandoc&lt;/em&gt; call, using the &lt;code&gt;add_argument&lt;/code&gt; method I added to &lt;code&gt;pyandoc.Document&lt;/code&gt; in [#solution-3].&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Footnotes&lt;/em&gt; - supported out-of-the-box by &lt;em&gt;Pandoc&lt;/em&gt;. Just make sure to have an empty line before and after the footnotes definitions.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Abbreviations&lt;/em&gt; - not that important, so I deserted this feature&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Table of Contents&lt;/em&gt; - a bit tricky. &lt;em&gt;Pandoc&lt;/em&gt; uses the &lt;code&gt;--toc&lt;/code&gt; option to generate a TOC. I needed a way for the renderer to decide if a TOC was really desired. I decided that it will be added to posts that begin with [TOC], because that was sort-of the way the &lt;em&gt;Python-Markdown&lt;/em&gt; TOC extension did it. So my renderer: -- looks for the &lt;code&gt;[TOC]&lt;/code&gt; tag at the beginning of the post -- strips off the tag -- replaces it with an &lt;em&gt;HTML&lt;/em&gt; &lt;code&gt;&amp;lt;a name=&amp;quot;TOC&amp;quot;&amp;gt;&amp;lt;/a&amp;gt;&lt;/code&gt; tag -- adds a &lt;em&gt;toc&lt;/em&gt; argument via the &lt;code&gt;pyandoc.Document&lt;/code&gt; class -- the TOC is inserted by &lt;em&gt;Pandoc&lt;/em&gt; only if the &lt;code&gt;standalone&lt;/code&gt; option is given or a suitable &lt;em&gt;template&lt;/em&gt; is given, so I created a template and gave it to &lt;em&gt;Pandoc&lt;/em&gt; using the &lt;code&gt;add_argument&lt;/code&gt; method:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;
    $toc$
    $body$
&lt;/pre&gt;

&lt;h2 id="problem-4"&gt;&lt;a href="#problem-4"&gt;Problem 4&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;How to get a real &lt;em&gt;bib&lt;/em&gt; file? I use &lt;a href="http://www.mendeley.com/"&gt;Mendeley&lt;/a&gt; to manage my references, so do I need to export the &lt;em&gt;bib&lt;/em&gt; file from &lt;em&gt;Mendeley&lt;/em&gt; each time I add a new document?&lt;/p&gt;
&lt;h2 id="solution-4"&gt;&lt;a href="#solution-4"&gt;Solution 4&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;No, as it happens, &lt;a href="http://blog.mendeley.com/tipstricks/how-to-series-generate-bibtex-files-for-your-collections-for-use-in-latex-part-3-of-12/"&gt;Mendeley can sync to a bib file&lt;/a&gt;. This feature was designed for people writing papers with &lt;em&gt;LaTeX&lt;/em&gt; but it is useful for me as well. So as long as I use &lt;em&gt;Mendeley&lt;/em&gt;, I just need to point the renderer to the &lt;em&gt;bib&lt;/em&gt; file I sync to &lt;em&gt;Mendeley&lt;/em&gt; and that's it - this is done by giving the renderer factory a suitable argument &lt;code&gt;bib=/path/to/library.bib&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;CSL files are easier - just download the ones you want from &lt;a href="http://www.zotero.org/styles"&gt;Zotero Style Repository&lt;/a&gt; and place the in the &lt;code&gt;sys.path&lt;/code&gt; or in the &lt;code&gt;pandoc/csl&lt;/code&gt; folder.&lt;/p&gt;
&lt;h2 id="problem-5"&gt;&lt;a href="#problem-5"&gt;Problem 5&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As you can see in the &lt;a href="#examples"&gt;examples below&lt;/a&gt;, the references are not linked. Also it would be nice to create ciations by specifing a DOI and without a &lt;em&gt;bib&lt;/em&gt; file, like it is down using &lt;a href="http://www.carlboettiger.info/2012/05/30/knitcitations.html"&gt;knitcitations in R&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;But I'll leave that for another day.&lt;/p&gt;
&lt;h2 id="examples"&gt;&lt;a href="#examples"&gt;Examples&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A few exmamples of how I write the &lt;em&gt;Markdown&lt;/em&gt; and how it looks on the blog:&lt;/p&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;... in a process called *Muller&amp;#39;s Ratchet* [@Muller1964; @Haigh1978].&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;... in a process called &lt;em&gt;Muller's Ratchet&lt;/em&gt; &lt;span class="citation"&gt;(Muller 1964; Haigh 1978)&lt;/span&gt;.&lt;/p&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;.. as suggested by Drake [-@Drake1991].&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;.. as suggested by Drake &lt;span class="citation"&gt;(1991)&lt;/span&gt;.&lt;/p&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;My model is based on that by @Hadany2003 who showed...&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;My model is based on that by &lt;span class="citation"&gt;Hadany and Beker (2003)&lt;/span&gt; who showed...&lt;/p&gt;
&lt;h2 id="references"&gt;&lt;a href="#references"&gt;References&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Drake, John W. 1991. &amp;#8220;A Constant Rate of Spontaneous Mutation in DNA-based Microbes.&amp;#8221; &lt;em&gt;Proceedings of the National Academy of Sciences of the United States of America&lt;/em&gt; 88 (16) (aug): 7160&amp;#8211;4. doi:10.1073/pnas.88.16.7160. &lt;a href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=52253" title="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=52253"&gt;http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=52253&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Hadany, Lilach, and Tuvik Beker. 2003. &amp;#8220;On the Evolutionary Advantage of Fitness-associated Recombination.&amp;#8221; &lt;em&gt;Genetics&lt;/em&gt; 165 (4) (dec): 2167&amp;#8211;79. &lt;a href="http://www.ncbi.nlm.nih.gov/pubmed/14704195" title="http://www.ncbi.nlm.nih.gov/pubmed/14704195"&gt;http://www.ncbi.nlm.nih.gov/pubmed/14704195&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Haigh, John. 1978. &amp;#8220;The Accumulation of Deleterious Genes in a Population - Muller&amp;#8217;s Ratchet.&amp;#8221; &lt;em&gt;Theoretical Population Biology&lt;/em&gt; 14 (2) (oct): 251&amp;#8211;267. doi:10.1016/0040-5809(78)90027-8. &lt;a href="http://dx.doi.org/10.1016/0040-5809(78)90027-8" title="http://dx.doi.org/10.1016/0040-5809(78)90027-8"&gt;http://dx.doi.org/10.1016/0040-5809(78)90027-8&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Muller, Herman J. 1964. &amp;#8220;The Relation of Recombination To Mutational Advance.&amp;#8221; &lt;em&gt;Mutation Research/Fundamental and Molecular Mechanisms of Mutagenesis&lt;/em&gt; 1 (1) (may): 2&amp;#8211;9. doi:10.1016/0027-5107(64)90047-8. &lt;a href="http://dx.doi.org/10.1016/0027-5107(64)90047-8" title="http://dx.doi.org/10.1016/0027-5107(64)90047-8"&gt;http://dx.doi.org/10.1016/0027-5107(64)90047-8&lt;/a&gt;.&lt;/p&gt;
&lt;div class="footnotes"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn1"&gt;&lt;p&gt;The main Python module underlying my &lt;a href="https://github.com/yoavram/yoavram.github.com/tree/source"&gt;Python static site generator&lt;/a&gt;.&lt;a href="#fnref1"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Icons for the blog</title>
    <id>http://blog.yoavram.com/icons-for-the-blog/</id>
    <updated>2012-10-11T14:59:00Z</updated>
    <link href="http://blog.yoavram.com/icons-for-the-blog/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href="#the-problem"&gt;The problem&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#the-solution"&gt;The solution&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#font-awesome"&gt;Font Awesome&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a name='TOC'&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="the-problem"&gt;&lt;a href="#the-problem"&gt;The problem&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To build this blog I used the wonderful &lt;a href="http://twitter.github.com/bootstrap/index.html"&gt;Twitter Bootstrap&lt;/a&gt; framework. It's hard to define what it is, so I'll leave it for another time. &lt;em&gt;Twitter Bootstrap&lt;/em&gt; comes packed with 120 icons packaged under the name &lt;a href="http://glyphicons.com/"&gt;Glyphicons&lt;/a&gt; &lt;em&gt;Halflings&lt;/em&gt;. These are a subset of the &lt;em&gt;Glyphicons Free&lt;/em&gt; set, and they include most of the little icons you see around the blog, like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the user icon: &lt;i class="icon-user"&gt;&lt;/i&gt;&lt;/li&gt;
&lt;li&gt;the time icon: &lt;i class="icon-time"&gt;&lt;/i&gt;&lt;/li&gt;
&lt;li&gt;the tag icon: &lt;i class="icon-tag"&gt;&lt;/i&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For a complete list visit either &lt;em&gt;Glyphicons&lt;/em&gt; or &lt;a href="http://twitter.github.com/bootstrap/base-css.html#icons"&gt;Twitter Bootstrap icons documentation&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;But when I built the top navigation bar, I saw that I needed something more - I needed a button for my &lt;a href="http://en.wikipedia.org/wiki/Web_feed"&gt;web feed&lt;/a&gt;. Web feeds (or RSS) have distinctive icons, but the &lt;em&gt;Glyphicons Halflings&lt;/em&gt; set didn't have the feedicon. But there is an RSS icon in &lt;em&gt;Glyphicons Free&lt;/em&gt; - here it is &lt;i class="glyphicon-rss"&gt;&lt;/i&gt;.&lt;/p&gt;
&lt;p&gt;So how do I add it to my site?&lt;/p&gt;
&lt;p&gt;The thing to understand is that these icons are not used like any image that you can put using an HTML &lt;code&gt;img&lt;/code&gt; tag. The icons are packed together in a small &lt;em&gt;png&lt;/em&gt; file and are parsed using a special &lt;em&gt;css&lt;/em&gt; file. This is called a &lt;a href="http://en.wikipedia.org/wiki/Sprite_(computer_graphics)#Sprites_by_CSS"&gt;CSS sprite&lt;/a&gt;. The advantage is that the browser only asks for a single &lt;em&gt;png&lt;/em&gt; file and a single &lt;em&gt;css&lt;/em&gt; file for all icons, reducing requests to the server. But these &lt;em&gt;png&lt;/em&gt; and &lt;em&gt;css&lt;/em&gt; were pre-packed in &lt;em&gt;Twitter Bootstrap&lt;/em&gt; - I simply downloaded &lt;em&gt;Twitter Bootstrap&lt;/em&gt; and put it in my &lt;em&gt;static&lt;/em&gt; directory, and from then on I could use icons like this: &lt;code&gt; &amp;lt;i class=&amp;quot;icon-camera&amp;quot;&amp;gt;&amp;lt;/i&amp;gt; &lt;/code&gt; produces this icon - &lt;i class="icon-camera"&gt;&lt;/i&gt;.&lt;/p&gt;
&lt;p&gt;So how do I use the &lt;em&gt;Glyphicons Free&lt;/em&gt; icon set, that has 400 icons including my desired &lt;i class="glyphicon-rss"&gt;&lt;/i&gt;?&lt;/p&gt;
&lt;p&gt;At first I downloaded the &lt;em&gt;Glyphicons Free&lt;/em&gt; set from their website. But this download has two problems:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There is no CSS sprite - instead of one &lt;em&gt;png&lt;/em&gt; and one &lt;em&gt;css&lt;/em&gt; I got 400 &lt;em&gt;png&lt;/em&gt;s...&lt;/li&gt;
&lt;li&gt;The icons are 24x24 pixels, instead of 14x14, like the Halflings...&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A quick goole led me to a few sites that offered CSS sprites for &lt;em&gt;Glyphicons Free&lt;/em&gt; (for example &lt;a href="http://supercerebral.com/glyphicons-to-halflings-sprite/"&gt;here&lt;/a&gt;, but each had its own problem. Until I found the right place &lt;a href="http://rnikitin.tumblr.com/post/28834314453/all-glyphicons-as-12px-is-css-sprite-fot-bootstrap"&gt;rnitkin&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id="the-solution"&gt;&lt;a href="#the-solution"&gt;The solution&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;On this blog post there are both a &lt;a href="/static/glyphicons.png"&gt;glyphicons.png&lt;/a&gt; and a &lt;a href="/static/glyphicons.css"&gt;glyphicons.css&lt;/a&gt;. You can download them and use them. All you need to do, after putting them on some folder of your site:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Add the &lt;em&gt;css&lt;/em&gt; file to the &lt;code&gt;head&lt;/code&gt; of any &lt;em&gt;HTML&lt;/em&gt; file that uses the icons - change the &lt;code&gt;href&lt;/code&gt; accordingly:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="prettyprint"&gt;
&amp;lt;link href="/static/glyphicons.css" rel="stylesheet"&gt;
&lt;/pre&gt;
  
&lt;ul&gt;
&lt;li&gt;Change the URL of the &lt;em&gt;png&lt;/em&gt; file in the &lt;em&gt;css&lt;/em&gt; file to point at where the &lt;em&gt;png&lt;/em&gt; file is:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="prettyprint"&gt;
background-image: url("images/glyphicons-2.png");
&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Alternatively, you can change the URL in the &lt;code&gt;head&lt;/code&gt; of your &lt;em&gt;HTML&lt;/em&gt; file:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="prettyprint"&gt;
[class^="glyphicon-"] { background-image: url("/static/glyphicons.png"); } 
&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Now you can use icons from &lt;em&gt;Glyphicons Free&lt;/em&gt; like this:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="prettyprint"&gt;
Hospital &amp;lt;i class="glyphicon-hospital"&gt;&lt;/i&gt;
&lt;/pre&gt;
&lt;pre&gt;
Hospital &lt;i class="glyphicon-hospital"&gt;&lt;/i&gt;
&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;For a mapping between icon and its name, like the one for &lt;em&gt;Glyphicons Halflings&lt;/em&gt; on the &lt;a href="http://twitter.github.com/bootstrap/base-css.html#icons"&gt;Twitter Bootstrap icons documentation&lt;/a&gt;, you can check out &lt;a href="http://maximals.ru/project/sprite/glyphicons/"&gt;MaximaAL's site&lt;/a&gt;. Just change the names from &lt;code&gt;gi-XXX&lt;/code&gt; to &lt;code&gt;glyphicon-XXX&lt;/code&gt;. It doesn't always work though, so the last resort is to look at the &lt;em&gt;css&lt;/em&gt; file.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Make sure you give proper attribution: the &lt;a href="http://glyphicons.com/glyphicons-licenses/"&gt;Glyphicons License&lt;/a&gt; page states that the use of Glyphonics Free is, well, free, but you must include a link to &lt;a href="http://glyphonics.com/"&gt;http://glyphonics.com/&lt;/a&gt; and include the &lt;a href="http://creativecommons.org/licenses/by/3.0/"&gt;CC-BY 3.0&lt;/a&gt; license.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;You might be able to install the icons from this &lt;a href="https://bitbucket.org/creat1va/compass-glyphicons"&gt;project&lt;/a&gt;, especially if you're a Ruby user. You can also het a &lt;em&gt;_white&lt;/em&gt; version.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="font-awesome"&gt;&lt;a href="#font-awesome"&gt;Font Awesome&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;One last thing. During the search for the solution (15 mins?) I found someone that suggested to use the &lt;a href="http://fortawesome.github.com/Font-Awesome/"&gt;Font Awesome&lt;/a&gt; icon set instead of &lt;em&gt;Glyphicons&lt;/em&gt;, so I tried that. First of all, the &lt;em&gt;Font Awesome&lt;/em&gt; site is... awesome. It took me one minute to understand how I need to do, to follow the instructions, and transition my site to &lt;em&gt;Font Awesome&lt;/em&gt;. The integration with &lt;em&gt;Twitter Bootstrap&lt;/em&gt; is very easy. The icon set is large, and it looks nice, but... not as nice as &lt;em&gt;Glyphonics&lt;/em&gt; looks. So I decided I'd stick with &lt;em&gt;Glyphicons&lt;/em&gt;. I will say that &lt;em&gt;Font Awesome&lt;/em&gt;'s social icons (twitter and company) are nicer, maybe because the &lt;em&gt;Glyphicons&lt;/em&gt; social icons have a black background and they don't look so good at 14x14 pixels.&lt;/p&gt;
&lt;p&gt;You can, of course, decide for yourself. Here are screenshots of the navigation bar with &lt;a href="http://i.imgur.com/3RFfm.png"&gt;Glyphonics&lt;/a&gt; and here it is with &lt;a href="http://i.imgur.com/WLVAM.png"&gt;Font Awesome&lt;/a&gt;. If you would like to see the code, here are the commits for &lt;a href="https://bitbucket.org/yoavram/msb/changeset/48d36660697bc022548e5476e40157c894aa3a99"&gt;Glyphonics&lt;/a&gt; and for &lt;a href="https://bitbucket.org/yoavram/msb/changeset/9a7b530667faeda8da08d9ba932e11622d07287b"&gt;Font Awesome&lt;/a&gt;.&lt;/p&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Markdown links and footnotes</title>
    <id>http://blog.yoavram.com/markdown-links-and-footnotes/</id>
    <updated>2012-10-11T09:21:00Z</updated>
    <link href="http://blog.yoavram.com/markdown-links-and-footnotes/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href="#links"&gt;Links&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#footnotes"&gt;Footnotes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a name='TOC'&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Following are examples of how to do links and footnotes in &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id="links"&gt;&lt;a href="#links"&gt;Links&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href="http://daringfireball.net/projects/markdown/syntax#link"&gt;Links&lt;/a&gt; can be written in several ways:&lt;/p&gt;
&lt;h4 id="inline"&gt;&lt;a href="#inline"&gt;Inline&lt;/a&gt;&lt;/h4&gt;
&lt;pre&gt;
Here is a link to [my website](http://www.yoavram.com).
&lt;/pre&gt;
&lt;p&gt;Here is a link to &lt;a href="http://www.yoavram.com"&gt;my website&lt;/a&gt;.&lt;/p&gt;
&lt;h4 id="reference"&gt;&lt;a href="#reference"&gt;Reference&lt;/a&gt;&lt;/h4&gt;
&lt;pre&gt;
Now you can see a link to [somewhere], and another to [neverwhere][1].
&lt;/pre&gt;
&lt;p&gt;Now you can see a link to &lt;a href="http://somewhere.com" title="Somewhere"&gt;somewhere&lt;/a&gt;, and another to &lt;a href="http://neverwhere.com/"&gt;neverwhere&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Try the tooltip on &lt;em&gt;somehwere&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Make sure you stick these reference at the bottom, or wherever you want:&lt;/p&gt;
&lt;pre&gt;
[somewhere]: http://somewhere.com "Somewhere"
[1]: http://neverwhere.com/
&lt;/pre&gt;

&lt;h4 id="automatic"&gt;&lt;a href="#automatic"&gt;Automatic&lt;/a&gt;&lt;/h4&gt;
&lt;pre&gt;
There are also automatic links, see &amp;lt;http://daringfireball.net/projects/markdown/syntax#autolink&gt;
&lt;/pre&gt;
&lt;p&gt;There are also automatic links, see &lt;a href="http://daringfireball.net/projects/markdown/syntax#autolink"&gt;http://daringfireball.net/projects/markdown/syntax#autolink&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="footnotes"&gt;&lt;a href="#footnotes"&gt;Footnotes&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href="http://freewisdom.org/projects/python-markdown/Footnotes"&gt;Footnotes&lt;/a&gt; are useful:&lt;/p&gt;
&lt;pre&gt;
You can see a footnote here[^here].
&lt;/pre&gt;
&lt;p&gt;You can see a footnote here&lt;sup&gt;&lt;a href="#fn1" class="footnoteRef" id="fnref1"&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;Click on the little &lt;em&gt;1&lt;/em&gt; to see the footnote. Again, you'll need to put this somewhere, usually at the bottom:&lt;/p&gt;
&lt;pre&gt;
[^here]: This a footnote, it leads to [somewhere] but not much *else*
&lt;/pre&gt;

&lt;div class="footnotes"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn1"&gt;&lt;p&gt;This a footnote, it leads to &lt;a href="http://somewhere.com" title="Somewhere"&gt;somewhere&lt;/a&gt; but not much &lt;em&gt;else&lt;/em&gt;&lt;a href="#fnref1"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content>
  </entry>
  <entry xml:base="http://blog.yoavram.com/recent.atom">
    <title type="text">Blogging with math and code</title>
    <id>http://blog.yoavram.com/blogging-with-math-and-code/</id>
    <updated>2012-10-03T13:05:00Z</updated>
    <link href="http://blog.yoavram.com/blogging-with-math-and-code/" />
    <author>
      <name></name>
    </author>
    <content type="html">&lt;ul&gt;
&lt;li&gt;&lt;a href="#examples"&gt;Examples&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#math"&gt;Math&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#source-code"&gt;Source Code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#explanations"&gt;Explanations&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href="#math-1"&gt;Math&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#source-code-1"&gt;Source Code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a name='TOC'&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="examples"&gt;&lt;a href="#examples"&gt;Examples&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="math"&gt;&lt;a href="#math"&gt;Math&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;When &lt;span class="math"&gt;\(a \ne 0\)&lt;/span&gt;, there are two solutions to &lt;span class="math"&gt;\(ax^2 + bx + c = 0\)&lt;/span&gt; and they are &lt;span class="math"&gt;\[
x = {-b \pm \sqrt{b^2-4ac} \over 2a}.
\]&lt;/span&gt;&lt;/p&gt;
&lt;h3 id="source-code"&gt;&lt;a href="#source-code"&gt;Source Code&lt;/a&gt;&lt;/h3&gt;
&lt;h4 id="java"&gt;&lt;a href="#java"&gt;Java&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;class Blog {
public:
  // Blog
  static const string BLOG = &amp;quot;Blog&amp;quot;;
}&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id="python"&gt;&lt;a href="#python"&gt;Python&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;#!/usr/bin/python
def pages_by_datetime(limit=0, latest_first=True):
    # Articles are pages with a publication date
    articles = (p for p in pages if &amp;#39;datetime&amp;#39; in p.meta)

    # Show the 10 most recent articles, most recent first.
    articles = sorted(articles, reverse=latest_first, key=lambda p: p.meta[&amp;#39;datetime&amp;#39;])
    if limit:
        return articles[:limit]
    else:
        return articles&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id="inline-code"&gt;&lt;a href="#inline-code"&gt;Inline code&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Small code elements like &lt;code&gt;print 'Hello World!'&lt;/code&gt; can be put into HTML &lt;code&gt;&amp;lt;code&amp;gt;&lt;/code&gt; elements.&lt;/p&gt;
&lt;h2 id="explanations"&gt;&lt;a href="#explanations"&gt;Explanations&lt;/a&gt;&lt;/h2&gt;
&lt;h3 id="math-1"&gt;&lt;a href="#math-1"&gt;Math&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Math is written in &lt;span class="math"&gt;\(LaTeX\)&lt;/span&gt;&lt;sup&gt;&lt;a href="#fn1" class="footnoteRef" id="fnref1"&gt;1&lt;/a&gt;&lt;/sup&gt; is written inside the &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt;&lt;sup&gt;&lt;a href="#fn2" class="footnoteRef" id="fnref2"&gt;2&lt;/a&gt;&lt;/sup&gt; text using &lt;code&gt;$&lt;/code&gt; (once for inline, two for display mode). &lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt;, which is used to convert the &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt; to HTML, is informed that &lt;span class="math"&gt;\(LaTeX\)&lt;/span&gt; is to be converted to mathematical notation in the browser using &lt;a href="http://www.mathjax.org/"&gt;MathJax&lt;/a&gt; javascript by specifing the command line argument &lt;code&gt;--mathjax&lt;/code&gt;. &lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt; then converts &lt;code&gt;$&lt;/code&gt; to &lt;code&gt;(&lt;/code&gt; or &lt;code&gt;)&lt;/code&gt; to start and finish &lt;span class="math"&gt;\(LaTeX\)&lt;/span&gt; blocks and doesn't parse &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt; inside these blocks.&lt;/p&gt;
&lt;p&gt;To enable &lt;a href="http://www.mathjax.org/"&gt;MathJax&lt;/a&gt;, you put the following in the &lt;code&gt;&lt;head\&gt;&lt;/code&gt; of your HTML file:&lt;/p&gt;
&lt;pre class="prettyprint linenums:1"&gt;&lt;code&gt;&amp;lt;script type=&amp;quot;text/x-mathjax-config&amp;quot;&amp;gt;
  MathJax.Hub.Config({
            &amp;quot;HTML-CSS&amp;quot;: { availableFonts: [&amp;quot;STIX&amp;quot;, &amp;quot;TeX&amp;quot;], 
                          linebreaks: { automatic: true }
            }
  });
&amp;lt;/script&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot;
  src=&amp;quot;http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML&amp;quot;&amp;gt;
&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The confguration parameters are as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;availableFonts&lt;/code&gt; tells it to prefer using the &lt;a href="http://www.stixfonts.org/"&gt;STIX&lt;/a&gt; font if it is available.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;linebreaks&lt;/code&gt; tells it to automatically break (wrap) long equations.&lt;/li&gt;
&lt;/ul&gt;
Now you can write:
&lt;pre&gt;
    $LaTeX$ is cool:
    $$
    p' = p + (1-p)(1-s)\mu
    $$
&lt;/pre&gt;
    
&lt;p&gt;to get the following result:&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(LaTeX\)&lt;/span&gt; is cool: &lt;span class="math"&gt;\[
p&amp;#39; = p + (1-p)(1-s)\mu
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;For more information visit the &lt;a href="http://docs.mathjax.org/en/latest/output.html"&gt;documentation&lt;/a&gt;&lt;sup&gt;&lt;a href="#fn3" class="footnoteRef" id="fnref3"&gt;3&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;h3 id="source-code-1"&gt;&lt;a href="#source-code-1"&gt;Source Code&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Code is written inside the &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt; markup language by indenting it with a tab or four space. The &lt;a href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt; is converted to HTML with &lt;a href="http://johnmacfarlane.net/pandoc/"&gt;Pandoc&lt;/a&gt;, which recognized these indented lines and wraps them with a &lt;code&gt;&amp;lt;pre&amp;gt;&lt;/code&gt; element. The CSS class given to the &lt;code&gt;&amp;lt;pre&amp;gt;&lt;/code&gt; element is set to &lt;code&gt;prettyprint&lt;/code&gt;, which is then highlighted in the browser using &lt;a href="http://google-code-prettify.googlecode.com/"&gt;Google code prettifier&lt;/a&gt; javascript which automatically identifies the language. The CSS class is actually &lt;code&gt;prettyprint linenum:1&lt;/code&gt; which tells the highlighter to number the lines.&lt;/p&gt;
&lt;p&gt;See the &lt;a href="http://johnmacfarlane.net/pandoc/README.html#indented-code-blocks"&gt;Pandoc handbook&lt;/a&gt; for instructions on the indented code blocks and the code prettifier &lt;a href="http://google-code-prettify.googlecode.com/svn/trunk/README.html"&gt;README&lt;/a&gt; for detailed instructions on the highlighting mechanism. It's very easy to use and is the highligher used by &lt;a href="http://code.google.com"&gt;Google Code&lt;/a&gt; and &lt;a href="http://stackoverflow.com/"&gt;stackoverflow.com&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If you have problems displaying HTML or XML source I suggest trying to replace &lt;code&gt;&amp;lt;&lt;/code&gt; with &lt;code&gt;&amp;amp;lt;&lt;/code&gt;&lt;sup&gt;&lt;a href="#fn4" class="footnoteRef" id="fnref4"&gt;4&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;For a nice example of different highlighting styles you can use (by replacing the default &lt;code&gt;prettify.css&lt;/code&gt; file), see &lt;a href="http://demo.stanleyhlng.com/prettify-js/?id=sons-of-obsidian-dark"&gt;Stanley Ng's website&lt;/a&gt;.&lt;/p&gt;
&lt;div class="footnotes"&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id="fn1"&gt;&lt;p&gt;&lt;a href="http://texify.com/"&gt;Online LaTeX editor&lt;/a&gt;&lt;a href="#fnref1"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn2"&gt;&lt;p&gt;&lt;a href="http://www.ctrlshift.net/project/markdowneditor/"&gt;Online Markdown editor&lt;/a&gt;&lt;a href="#fnref2"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn3"&gt;&lt;p&gt;&lt;a href="http://www.onemathematicalcat.org/MathJaxDocumentation/TeXSyntax.htm"&gt;Online MathJax debugger&lt;/a&gt;.&lt;a href="#fnref3"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id="fn4"&gt;&lt;p&gt;&lt;a href="http://www.htmlescape.net/htmlescape_tool.html"&gt;Online HTML escaping tool&lt;/a&gt;&lt;a href="#fnref4"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content>
  </entry>
</feed>
